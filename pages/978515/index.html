<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | Blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="学习文档">
    <meta name="keywords" content="个人技术博客">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.cfb18a3c.css" as="style"><link rel="preload" href="/assets/js/app.87eabd22.js" as="script"><link rel="preload" href="/assets/js/2.3f274d60.js" as="script"><link rel="preload" href="/assets/js/41.ab55b8a0.js" as="script"><link rel="prefetch" href="/assets/js/10.eb41a99f.js"><link rel="prefetch" href="/assets/js/11.77368eff.js"><link rel="prefetch" href="/assets/js/12.c4413aa8.js"><link rel="prefetch" href="/assets/js/13.818ece60.js"><link rel="prefetch" href="/assets/js/14.088e3093.js"><link rel="prefetch" href="/assets/js/15.c213ea39.js"><link rel="prefetch" href="/assets/js/16.3c3e9f27.js"><link rel="prefetch" href="/assets/js/17.d3ccc168.js"><link rel="prefetch" href="/assets/js/18.076de409.js"><link rel="prefetch" href="/assets/js/19.c2b90abd.js"><link rel="prefetch" href="/assets/js/20.ac1bd3a9.js"><link rel="prefetch" href="/assets/js/21.9424afad.js"><link rel="prefetch" href="/assets/js/22.429507f5.js"><link rel="prefetch" href="/assets/js/23.656e2cdf.js"><link rel="prefetch" href="/assets/js/24.0f0b320d.js"><link rel="prefetch" href="/assets/js/25.07ef8288.js"><link rel="prefetch" href="/assets/js/26.b16e010f.js"><link rel="prefetch" href="/assets/js/27.45670c97.js"><link rel="prefetch" href="/assets/js/28.81f582d5.js"><link rel="prefetch" href="/assets/js/29.33ef3f79.js"><link rel="prefetch" href="/assets/js/3.ef8a815b.js"><link rel="prefetch" href="/assets/js/30.f12a6485.js"><link rel="prefetch" href="/assets/js/31.f105868b.js"><link rel="prefetch" href="/assets/js/32.0ef564c1.js"><link rel="prefetch" href="/assets/js/33.07d8ec2a.js"><link rel="prefetch" href="/assets/js/34.882e4e22.js"><link rel="prefetch" href="/assets/js/35.c832b83f.js"><link rel="prefetch" href="/assets/js/36.0dbf6a03.js"><link rel="prefetch" href="/assets/js/37.fd99a32f.js"><link rel="prefetch" href="/assets/js/38.184c845f.js"><link rel="prefetch" href="/assets/js/39.81758d0e.js"><link rel="prefetch" href="/assets/js/4.d3d1e88c.js"><link rel="prefetch" href="/assets/js/40.1e3bd4dd.js"><link rel="prefetch" href="/assets/js/42.1f093db2.js"><link rel="prefetch" href="/assets/js/43.446ab6d2.js"><link rel="prefetch" href="/assets/js/44.e52d54e8.js"><link rel="prefetch" href="/assets/js/45.75499d54.js"><link rel="prefetch" href="/assets/js/46.427df341.js"><link rel="prefetch" href="/assets/js/47.6d75abc4.js"><link rel="prefetch" href="/assets/js/48.243db9bf.js"><link rel="prefetch" href="/assets/js/49.05a742ec.js"><link rel="prefetch" href="/assets/js/5.b300920d.js"><link rel="prefetch" href="/assets/js/50.ea23c038.js"><link rel="prefetch" href="/assets/js/51.354723b3.js"><link rel="prefetch" href="/assets/js/52.ede87da4.js"><link rel="prefetch" href="/assets/js/53.8ac13bc8.js"><link rel="prefetch" href="/assets/js/54.1ad946fd.js"><link rel="prefetch" href="/assets/js/55.968cbe29.js"><link rel="prefetch" href="/assets/js/56.621ebc28.js"><link rel="prefetch" href="/assets/js/57.cde308fa.js"><link rel="prefetch" href="/assets/js/58.ccdebd28.js"><link rel="prefetch" href="/assets/js/59.b795d1eb.js"><link rel="prefetch" href="/assets/js/6.97cc3fc3.js"><link rel="prefetch" href="/assets/js/60.501f0ca8.js"><link rel="prefetch" href="/assets/js/61.f62bf13b.js"><link rel="prefetch" href="/assets/js/62.c1fdb062.js"><link rel="prefetch" href="/assets/js/63.fe3a8610.js"><link rel="prefetch" href="/assets/js/64.4fa7e0e3.js"><link rel="prefetch" href="/assets/js/65.892c344b.js"><link rel="prefetch" href="/assets/js/66.b3527819.js"><link rel="prefetch" href="/assets/js/67.9df18578.js"><link rel="prefetch" href="/assets/js/68.32144aed.js"><link rel="prefetch" href="/assets/js/69.75a86074.js"><link rel="prefetch" href="/assets/js/7.eb6b49bc.js"><link rel="prefetch" href="/assets/js/70.4059a4d6.js"><link rel="prefetch" href="/assets/js/71.cc4a13cf.js"><link rel="prefetch" href="/assets/js/72.02759e45.js"><link rel="prefetch" href="/assets/js/73.59c2a228.js"><link rel="prefetch" href="/assets/js/74.88727dbb.js"><link rel="prefetch" href="/assets/js/75.4ddb830d.js"><link rel="prefetch" href="/assets/js/76.5e811159.js"><link rel="prefetch" href="/assets/js/77.7e3f8eee.js"><link rel="prefetch" href="/assets/js/78.ccdaceb5.js"><link rel="prefetch" href="/assets/js/79.f2091ce2.js"><link rel="prefetch" href="/assets/js/8.99785c7f.js"><link rel="prefetch" href="/assets/js/80.0ede5d5b.js"><link rel="prefetch" href="/assets/js/81.238d5d81.js"><link rel="prefetch" href="/assets/js/82.d84c389d.js"><link rel="prefetch" href="/assets/js/83.6a11da71.js"><link rel="prefetch" href="/assets/js/84.c4fd3186.js"><link rel="prefetch" href="/assets/js/85.59cee480.js"><link rel="prefetch" href="/assets/js/86.43e351f2.js"><link rel="prefetch" href="/assets/js/87.2a02418c.js"><link rel="prefetch" href="/assets/js/88.35fb4e70.js"><link rel="prefetch" href="/assets/js/89.8791d4d9.js"><link rel="prefetch" href="/assets/js/9.4f9148c2.js"><link rel="prefetch" href="/assets/js/90.b0df9752.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cfb18a3c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Blog" class="logo"> <span class="site-name can-hide">Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人学习笔记" class="dropdown-title"><a href="/pages/a31ae1/" class="link-title">个人学习笔记</a> <span class="title" style="display:none;">个人学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Docker</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ba54ad/" class="nav-link">Docker</a></li></ul></li><li class="dropdown-item"><h4>Redis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb03b7/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/pages/1aa945/" class="nav-link">Redis-Docker</a></li></ul></li><li class="dropdown-item"><h4>Mq</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1ef249/" class="nav-link">RocketMq</a></li><li class="dropdown-subitem"><a href="/pages/633ffb/" class="nav-link">RabbitMq</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/0ff885/" class="nav-link">技术笔记</a></div><div class="nav-item"><a href="/pages/aefe68/" class="nav-link">问题总结</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div> <a href="https://github.com/#" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="#"> <div class="blogger-info"><h3>船到桥头沉</h3> <span>==========</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人学习笔记" class="dropdown-title"><a href="/pages/a31ae1/" class="link-title">个人学习笔记</a> <span class="title" style="display:none;">个人学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Docker</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ba54ad/" class="nav-link">Docker</a></li></ul></li><li class="dropdown-item"><h4>Redis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bb03b7/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/pages/1aa945/" class="nav-link">Redis-Docker</a></li></ul></li><li class="dropdown-item"><h4>Mq</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1ef249/" class="nav-link">RocketMq</a></li><li class="dropdown-subitem"><a href="/pages/633ffb/" class="nav-link">RabbitMq</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/0ff885/" class="nav-link">技术笔记</a></div><div class="nav-item"><a href="/pages/aefe68/" class="nav-link">问题总结</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div> <a href="https://github.com/#" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/978515/" aria-current="page" class="active sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/978515/#_1、镜像相关命令" class="sidebar-link">1、镜像相关命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/978515/#_1、查看本地镜像" class="sidebar-link">1、查看本地镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_2、搜索镜像" class="sidebar-link">2、搜索镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_3、拉取镜像" class="sidebar-link">3、拉取镜像</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_4、删除镜像" class="sidebar-link">4、删除镜像</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#_2、容器相关命令" class="sidebar-link">2、容器相关命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/978515/#_1、查看容器" class="sidebar-link">1、查看容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_2、创建并启动容器" class="sidebar-link">2、创建并启动容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_3、停止并启动容器" class="sidebar-link">3、停止并启动容器</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#_4、文件拷贝" class="sidebar-link">4、文件拷贝</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#一、mysql容器部署" class="sidebar-link">一、MySQL容器部署</a></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#三、nginx容器部署" class="sidebar-link">三、Nginx容器部署</a></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#四、redis容器部署" class="sidebar-link">四、Redis容器部署</a></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#五、docker-compose简介-安装" class="sidebar-link">五、docker-compose简介&amp;安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/978515/#_1、-概念" class="sidebar-link">1、 概念</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_2、-组成" class="sidebar-link">2、 组成</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_3、安装" class="sidebar-link">3、安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_4、卸载" class="sidebar-link">4、卸载</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_5、常用命令参考" class="sidebar-link">5、常用命令参考</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#六、compose模版文件" class="sidebar-link">六、Compose模版文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#七、compose应用" class="sidebar-link">七、Compose应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/978515/#_1、-编写模版文件" class="sidebar-link">1、 编写模版文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_2、启动" class="sidebar-link">2、启动</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_3、-测试" class="sidebar-link">3、 测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#第三章-迁移备份仓库" class="sidebar-link">第三章 迁移备份仓库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/978515/#一、迁移与备份" class="sidebar-link">一、迁移与备份</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_1、-将docker容器保存为镜像" class="sidebar-link">1、 将Docker容器保存为镜像</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_2、-镜像备份" class="sidebar-link">2、 镜像备份</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_3、-镜像恢复与迁移" class="sidebar-link">3、 镜像恢复与迁移</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#二、-使用dockerfile创建镜像-根据我们的流程-制作镜像" class="sidebar-link">二、 使用Dockerfile创建镜像（根据我们的流程 制作镜像）</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_1、-什么是dockerfile文件" class="sidebar-link">1、 什么是Dockerfile文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_2、dockerfifile常用命令" class="sidebar-link">2、Dockerfifile常用命令</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_3、-使用dockerfile创建镜像" class="sidebar-link">3、 使用Dockerfile创建镜像</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_4、-基于镜像创建容器" class="sidebar-link">4、 基于镜像创建容器</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/978515/#使用" class="sidebar-link">使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/978515/#docker-compose简介-安装-用来创建容器" class="sidebar-link">docker-compose简介&amp;安装 		(用来创建容器)</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#compose应用" class="sidebar-link">Compose应用</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#编写模版文件" class="sidebar-link">编写模版文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header level3"><a href="/pages/978515/#使用dockerfile创建镜像-根据我们的流程-制作镜像" class="sidebar-link">使用Dockerfile创建镜像（根据我们的流程 制作镜像）</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_1、-什么是dockerfile文件-2" class="sidebar-link">1、 什么是Dockerfile文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_2、dockerfifile常用命令-2" class="sidebar-link">2、Dockerfifile常用命令</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_3、-使用dockerfile创建镜像-2" class="sidebar-link">3、 使用Dockerfile创建镜像</a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#" class="sidebar-link"></a></li><li class="sidebar-sub-header level4"><a href="/pages/978515/#_4、-基于镜像创建容器-2" class="sidebar-link">4、 基于镜像创建容器</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webSocket</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/pages/0ff885/#技术笔记" data-v-06225672>技术笔记</a></li><li data-v-06225672><a href="/pages/0ff885/#docker" data-v-06225672>docker</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>船到桥头沉</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-12-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Docker<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>原笔记 https://www.ydlclass.com</p> <h1 id="一、docker安装与启动"><a href="#一、docker安装与启动" class="header-anchor">#</a> 一、Docker安装与启动</h1> <p><strong>ubuntu软件默认安装位置</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>、下载的软件存放位置
/var/cache/apt/archives
<span class="token number">2</span>、安装后软件默认位置
/usr/share
<span class="token number">3</span>、可执行文件位置
/usr/bin
<span class="token number">4</span>、配置文件位置
/etc
<span class="token number">5</span>、lib文件位置
 /usr/lib
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <p>以下是在Ubuntu中安装Docker的步骤：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># step 1: 安装必要的一些系统工具</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> apt-transport-https ca-certificates <span class="token function">curl</span> software-properties-common
<span class="token comment"># step 2: 安装GPG证书</span>
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -
<span class="token comment"># Step 3: 写入软件源信息</span>
<span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> stable&quot;</span>
<span class="token comment"># Step 4: 更新并安装 Docker-CE</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> docker-ce

<span class="token comment"># 4、 安装docker；出现输入的界面都按 y </span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce
<span class="token comment"># 5、 查看docker版本 </span>
<span class="token function">docker</span> <span class="token parameter variable">-v</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>设置ustc镜像</strong></p> <p>ustc是老牌的linux镜像服务提供者了，还在遥远的ubuntu 5.04版本的时候就在用。ustc的docker镜像加速器速度很快。ustc docker mirror的优势之一就是不需要注册，是真正的公共服务。</p> <p>1、 编辑文件/etc/docker/daemon.json</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 执行如下命令： </span>
<span class="token function">mkdir</span> /etc/docker 
<span class="token function">vi</span> /etc/docker/daemon.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、在文件中加入下面内容</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#不能出现空格</span>
<span class="token punctuation">{</span>
<span class="token string">&quot;registry-mirrors&quot;</span>:<span class="token punctuation">[</span>
	<span class="token string">&quot;https://mirror.ccs.tencentyun.com&quot;</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Docker启动与停止命令</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 启动docker服务： </span>
systemctl start <span class="token function">docker</span> 
<span class="token comment"># 停止docker服务： </span>
systemctl stop <span class="token function">docker</span> 
<span class="token comment"># 重启docker服务： </span>
systemctl restart <span class="token function">docker</span> 
<span class="token comment"># 查看docker服务状态： </span>
systemctl status <span class="token function">docker</span> 
<span class="token comment"># 设置开机启动docker服务： </span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/kdqZWU9NXl72oOM.png" alt="image-20220801172055300"></p> <h2 id="_1、镜像相关命令"><a href="#_1、镜像相关命令" class="header-anchor">#</a> 1、镜像相关命令</h2> <p><strong>镜像</strong>：Docker镜像是由文件系统叠加而成（是一种文件的存储形式）；是docker中的核心概念，可以认为镜像就是对某些运行环境或者软件打的包，用户可以从docker仓库中下载基础镜像到本地，比如开发人员可以从docker仓库拉取（下载）一个只包含centos7系统的基础镜像，然后在这个镜像中安装jdk、mysql、Tomcat和自己开发的应用，最后将这些环境打成一个新的镜像。开发人员将这个新的镜像提交给测试人员进行测试，测试人员只需要在测试环境下运行这个镜像就可以了，这样就可以保证开发人员的环境和测试人员的环境完全一致。</p> <p><img src="https://s2.loli.net/2022/12/01/JsyIzdbupGDCTOk.png" alt="image-20220801154638733"></p> <h3 id="_1、查看本地镜像"><a href="#_1、查看本地镜像" class="header-anchor">#</a> <strong>1、查看本地镜像</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看镜像可以使用如下命令： </span>
<span class="token function">docker</span> images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/HAuCGeyPOzpd9Wg.png" alt="image-20220802004512134"></p> <p>REPOSITORY：镜像名称</p> <p>TAG：镜像标签</p> <p>IMAGE ID：镜像ID</p> <p>CREATED：镜像的创建日期</p> <p>SIZE：镜像大小</p> <h3 id="_2、搜索镜像"><a href="#_2、搜索镜像" class="header-anchor">#</a> <strong>2、搜索镜像</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 如果你需要从网络中查找需要的镜像，可以通过以下命令搜索 </span>
<span class="token function">docker</span> search 镜像名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/i3aTsPD1jGq7HYn.png" alt="image-20220802004640991"></p> <p>NAME：镜像名称</p> <p>DESCRIPTION：镜像描述</p> <p>STARS：用户评价，反应一个镜像的受欢迎程度</p> <p>OFFICIAL：是否官方</p> <p>AUTOMATED：自动构建，表示该镜像由Docker Hub自动构建流程创建的</p> <h3 id="_3、拉取镜像"><a href="#_3、拉取镜像" class="header-anchor">#</a> <strong>3、拉取镜像</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 拉取镜像就是从Docker仓库下载镜像到本地，镜像名称格式为 名称:版本号，如果版本号不指定则是最新的版本 命令如下： </span>
<span class="token function">docker</span> pull 镜像名称 
<span class="token comment"># 如拉取centos 7； </span>
<span class="token function">docker</span> pull centos:7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4、删除镜像"><a href="#_4、删除镜像" class="header-anchor">#</a> <strong>4、删除镜像</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 可以按照镜像id删除镜像，命令如下： </span>
<span class="token function">docker</span> rmi 镜像id
<span class="token comment"># 删除所有镜像</span>
<span class="token function">docker</span> rmi <span class="token function">docker</span> images <span class="token parameter variable">-q</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_2、容器相关命令"><a href="#_2、容器相关命令" class="header-anchor">#</a> 2、容器相关命令</h2> <p>容器，也是docker中的核心概念，容器是由镜像运行产生的运行实例。镜像和容器的关系，就如同Java语言中类和对象的关系。</p> <h3 id="_1、查看容器"><a href="#_1、查看容器" class="header-anchor">#</a> <strong>1、查看容器</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看正在运行的容器使用命令：</span>
<span class="token function">docker</span> <span class="token function">ps</span>
<span class="token comment"># 查看所有容器使用命令：</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/t3Y4I9rjVQWwPBK.png" alt="image-20220802005933035"></p> <h3 id="_2、创建并启动容器"><a href="#_2、创建并启动容器" class="header-anchor">#</a> <strong>2、创建并启动容器</strong></h3> <p>可以基于已有的镜像来创建和启动容器，创建与启动容器使用命令：docker run</p> <p><strong>参数说明</strong>：</p> <ul><li>-i：表示运行容器</li> <li>-t：表示容器启动后会进入其命令行。加入这两个参数后，容器创建就能登录进去。即分配一个伪终端。</li> <li>-d：在run后面加上-d参数,则会创建一个守护式容器在后台运行（这样创建容器后不会自动登录容器，如果只加-i -t两个参数，创建后就会自动进去容器）。</li> <li>--name :为创建的容器命名。</li> <li>-v：表示目录映射关系（前者是宿主机目录，后者是映射到宿主机上的目录），可以使用多个－v做多个目录或文件映射。注意：最好做目录映射，在宿主机上做修改，然后共享到容器上。</li> <li>-p：表示端口映射，前者是宿主机端口，后者是容器内的映射端口。可以使用多个-p做多个端口映射</li></ul> <p><strong>1</strong>）交互式容器</p> <p>以<strong>交互式</strong>方式创建并启动容器，启动完成后，直接进入当前容器。使用exit命令退出容器。需要注意的是以此种方式启动容器**，如果退出容器，则容器会进入停止状态**。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 先拉取一个镜像；这一步不是每次启动容器都要做的，而是因为前面我们删除了镜像，无镜像可用所以才再拉取一个 </span>
<span class="token function">docker</span> pull centos:7 
<span class="token comment">#创建并启动名称为 mycentos7 的交互式容器；下面指令中的镜像名称 centos:7 也可以使用镜像id </span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>testname centos:7 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>2</strong>）守护式容器</p> <p>创建一个守护式容器；如果对于一个需要长期运行的容器来说，我们可以创建一个守护式容器。命令如下（容器名称不能重复）：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#创建并启动守护式容器 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-di</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>testnname centos:7 
<span class="token comment">#登录进入容器命令为：</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> container_name <span class="token punctuation">(</span>或者 container_id<span class="token punctuation">)</span> /bin/bash
<span class="token comment">#（exit退出 时，容器不会停止） </span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> testname /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_3、停止并启动容器"><a href="#_3、停止并启动容器" class="header-anchor">#</a> <strong>3、停止并启动容器</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 停止正在运行的容器：docker stop 容器名称或者ID </span>
<span class="token function">docker</span> stop testname 
<span class="token comment"># 启动已运行过的容器：docker start 容器名称或者ID </span>
<span class="token function">docker</span> start testname
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4、文件拷贝"><a href="#_4、文件拷贝" class="header-anchor">#</a> 4、<strong>文件拷贝</strong></h3> <p>注意：容器在停止状态下也可以完成文件的拷贝</p> <p><strong>将linux宿主机中的文件拷贝到容器内可以使用命令：</strong></p> <p><code>docker cp 需要拷贝的文件或目录 容器名称:容器目录</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># docker cp 需要拷贝的文件或目录 容器名称:容器目录 </span>
<span class="token comment"># 复制abc.txt到mycentos2的容器的 / 目录下 </span>
<span class="token function">docker</span> <span class="token function">cp</span> aaa.txt testname:/root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>将文件从容器内拷贝出来到linux宿主机使用命令：</strong></p> <p><code>docker cp 容器名称:容器目录 需要拷贝的文件或目录</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># docker cp 容器名称:容器目录 需要拷贝的文件或目录</span>

<span class="token comment"># 在Linux宿主机器执行复制 </span>
<span class="token comment">#将容器mycentos2的/cba.txt文件复制到宿主机器的/root目录下 </span>
<span class="token function">docker</span> <span class="token function">cp</span> testname:/root/aaa.text /root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5C%E7%AC%94%E8%AE%B0%5CmyNote%5CDocker.assets%5Cimage-20221201152245616.png" alt="image-20221201152245616"></p> <h1 id="二-部署相关软件"><a href="#二-部署相关软件" class="header-anchor">#</a> 二 部署相关软件</h1> <h2 id="一、mysql容器部署"><a href="#一、mysql容器部署" class="header-anchor">#</a> 一、MySQL容器部署</h2> <p>1.拉取mysql镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mysql:8.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.创建容器，设置端口映射、目录映射</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 在/root目录下创建mysql目录用于存储mysql数据信息</span>
<span class="token function">mkdir</span> /root/mysql
<span class="token builtin class-name">cd</span> /root/mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">3307</span>:3306 <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span>qjj_mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/conf:/etc/mysql/conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/logs:/logs <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
mysql:8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -id \
-p 3307:3306 \
--name=qjj_mysql_3306 \
-v /root/mysql_3306/conf:/etc/mysql/conf.d \
-v /root/mysql_3306/logs:/logs \
-v /root/mysql_3306/data:/var/lib/mysql \
-e MYSQL_ROOT_PASSWORD=123456 \
mysql:8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>参数说明：
<ul><li><strong>-p 3307:3306</strong>：将容器的 3306 端口映射到宿主机的 3307 端口。</li> <li><strong>-v $PWD/conf:/etc/mysql/conf.d</strong>：将主机当前目录下的 conf/my.cnf 挂载到容器的 /etc/mysql/my.cnf。配置目录</li> <li><strong>-v $PWD/logs:/logs</strong>：将主机当前目录下的 logs 目录挂载到容器的 /logs。日志目录</li> <li><strong>-v $PWD/data:/var/lib/mysql</strong> ：将主机当前目录下的data目录挂载到容器的 /var/lib/mysql 。数据目录</li> <li>**-e MYSQL_ROOT_PASSWORD=123456：**初始化 root 用户的密码。</li></ul></li></ul> <p><img src="https://s2.loli.net/2022/12/01/BrgZpJR4aDcdlNV.png" alt="image-20220802014335044"></p> <p>4.进入容器，操作mysql</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> qjj_mysql /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/nPCEwOgIZyBScvx.png" alt="image-20220802014458508"></p> <p>5.使用外部机器连接容器中的mysql</p> <p><img src="https://s2.loli.net/2022/12/01/IgKRh7d1xkAuFO2.png" alt="image-20220802014616050"></p> <blockquote></blockquote> <h2 id="三、nginx容器部署"><a href="#三、nginx容器部署" class="header-anchor">#</a> 三、Nginx容器部署</h2> <p>1.搜索nginx镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> search nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/5o8QUTZEILOuvhj.png" alt="image-20220802015500236"></p> <p>2.拉取nginx镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/FS4OLpkgczQI3sA.png" alt="image-20220802015611869"></p> <p>3.创建容器，设置端口映射、目录映射</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 在/root目录下创建nginx目录用于存储nginx数据信息</span>
<span class="token function">mkdir</span> /root/nginx
<span class="token builtin class-name">cd</span> /root/nginx
<span class="token function">mkdir</span> conf
<span class="token builtin class-name">cd</span> conf
<span class="token comment"># 在~/nginx/conf/下创建nginx.conf文件,粘贴下面内容</span>
<span class="token function">vim</span> nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>user  nginx<span class="token punctuation">;</span>
worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>

error_log  /var/log/nginx/error.log warn<span class="token punctuation">;</span>
pid        /var/run/nginx.pid<span class="token punctuation">;</span>


events <span class="token punctuation">{</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    include       /etc/nginx/mime.types<span class="token punctuation">;</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    log_format  main  <span class="token string">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
                      <span class="token string">'$status $body_bytes_sent &quot;$http_referer&quot; '</span>
                      <span class="token string">'&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'</span><span class="token punctuation">;</span>

    access_log  /var/log/nginx/access.log  main<span class="token punctuation">;</span>

    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment">#tcp_nopush     on;</span>

    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token comment">#gzip  on;</span>

    include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>ydl_nginx <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/nginx/logs:/var/log/nginx <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/nginx/html:/usr/share/nginx/html <span class="token punctuation">\</span>
nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>参数说明：
<ul><li><strong>-p 80:80</strong>：将容器的 80端口映射到宿主机的 80 端口。</li> <li><strong>-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf</strong>：将主机当前目录下的 /conf/nginx.conf 挂载到容器的 :/etc/nginx/nginx.conf。配置目录</li> <li><strong>-v $PWD/logs:/var/log/nginx</strong>：将主机当前目录下的 logs 目录挂载到容器的/var/log/nginx。日志目录</li></ul></li></ul> <p>4.使用外部机器访问nginx</p> <p>http://192.168.246.128/</p> <p><img src="https://s2.loli.net/2022/12/01/1fxtHlbCGOLSVsa.png" alt="image-20220802015832349"></p> <p><strong>小结</strong>：</p> <blockquote><p>如果被占用了80端口，那么在指定映射的时候可以改变宿主机的端口映射，在访问时也需要带上端口号。</p></blockquote> <h2 id="四、redis容器部署"><a href="#四、redis容器部署" class="header-anchor">#</a> 四、Redis容器部署</h2> <p>2.拉取redis镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull redis:5.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.创建容器，设置端口映射</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="五、docker-compose简介-安装"><a href="#五、docker-compose简介-安装" class="header-anchor">#</a> 五、docker-compose简介&amp;安装</h2> <h4 id="_1、-概念"><a href="#_1、-概念" class="header-anchor">#</a> <strong>1、</strong> <strong>概念</strong></h4> <p>它<strong>是一个定义和运行多容器的</strong>docker应用工具。使用compose，你能通过YMAL文件配置你自己的服务，然后通过一个命令，你能使用配置文件创建和运行所有的服务。</p> <h4 id="_2、-组成"><a href="#_2、-组成" class="header-anchor">#</a> <strong>2、</strong> <strong>组成</strong></h4> <p>Docker-Compose将所管理的容器分为三层，分别是工程（project），服务（service）以及容器（container）。Docker-Compose运行目录下的所有文件（docker-compose.yml，extends文件或环境变量文件等）组成一个工程，若无特殊指定工程名即为当前目录名。一个工程当中可包含多个服务，每个服务中定义了容器运行的镜像，参数，依赖。一个服务当中可包括多个容器实例。</p> <ul><li><strong>服务（service）</strong>：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。每个服务都有自己的名字、使用的镜像、挂载的数据卷、所属的网络、依赖哪些其他服务等等，即以容器为粒度，用户需要Compose所完成的任务。</li> <li><strong>项目（project）</strong>：由一组关联的应用容器组成的一个完成业务单元，在docker-compose.yml中定义。即是Compose的一个配置文件可以解析为一个项目，Compose通过分析指定配置文件，得出配置文件所需完成的所有容器管理与部署操作。</li></ul> <p>Docker-Compose的工程配置文件默认为docker-compose.yml，可通过环境变量COMPOSE_FILE或-f参数自定义配置文件，其定义了多个有依赖关系的服务及每个服务运行的容器。</p> <p>使用一个Dockerfifile模板文件，可以让用户很方便的定义一个单独的应用容器。在工作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如：要部署一个Web项目，除了Web服务容器，往往还需要再加上后端的数据库服务容器，甚至还包括负载均衡容器等。</p> <h4 id="_3、安装"><a href="#_3、安装" class="header-anchor">#</a> <strong>3、安装</strong></h4> <p>Compose目前已经完全支持Linux、Mac OS和Windows，在我们安装Compose之前，需要先安装Docker。下面我们以编译好的二进制包方式安装在Linux系统中。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token string">&quot;https://github.com/docker/compose/releases/download/1.24.0/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">)</span></span>&quot;</span> <span class="token parameter variable">-o</span> /usr/local/bin/docker-compose 

<span class="token comment"># 设置文件可执行权限 </span>
<span class="token function">chmod</span> +x /usr/local/bin/docker-compose 

<span class="token comment"># 查看版本信息 </span>
<span class="token function">docker-compose</span> <span class="token parameter variable">-version</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_4、卸载"><a href="#_4、卸载" class="header-anchor">#</a> <strong>4、卸载</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 二进制包方式安装的，删除二进制文件即可 </span>
<span class="token function">rm</span> /usr/local/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_5、常用命令参考"><a href="#_5、常用命令参考" class="header-anchor">#</a> 5、<strong>常用命令参考</strong></h4> <p>使用Compose前，可以通过执行 docker-compose --help|-h 来查看Compose基本命令用法。</p> <p>也可以通过执行 docker-compose [COMMAND] --help 或者 docker-compose --help [COMMAND] 来查看某个具体的使用格式。</p> <p>可以知道Compose命令的基本的使用格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose [-f 参数...] [options] [COMMAND] [ARGS...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>命令选项如下：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-f，–file FILE指定使用的Compose模板文件，默认为docker-compose.yml，可以多次指定。 
-p，–project-name NAME指定项目名称，默认将使用所在目录名称作为项目名。 
-x-network-driver 使用Docker的可拔插网络后端特性（需要Docker 1.9 及以后版本） 
-x-network-driver DRIVER指定网络后端的驱动，默认为bridge（需要Docker 1.9 及以后版本） 
-verbose输出更多调试信息 
-v，-version打印版本并退出
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Docker Compose</strong>常用命令列表如下：</p> <table><thead><tr><th><strong>命令</strong></th> <th><strong>说明</strong></th></tr></thead> <tbody><tr><td>build</td> <td>构建项目中的服务容器</td></tr> <tr><td>help</td> <td>获得一个命令的帮助</td></tr> <tr><td>kill</td> <td>通过发送SIGKILL信号来强制停止服务容器</td></tr> <tr><td>confifig</td> <td>验证和查看compose文件配置</td></tr> <tr><td>create</td> <td>为服务创建容器。只是单纯的create，还需要使用start启动compose</td></tr> <tr><td>down</td> <td>停止并删除容器，网络，镜像和数据卷</td></tr> <tr><td>exec</td> <td>在运行的容器中执行一个命令</td></tr> <tr><td>logs</td> <td>查看服务容器的输出</td></tr> <tr><td>pause</td> <td>暂停一个服务容器</td></tr> <tr><td>port</td> <td>打印某个容器端口所映射的公共端口</td></tr> <tr><td>ps</td> <td>列出项目中目前的所有容器</td></tr> <tr><td>pull</td> <td>拉取服务依赖的镜像</td></tr> <tr><td>push</td> <td>推送服务镜像</td></tr> <tr><td>restart</td> <td>重启项目中的服务</td></tr> <tr><td>rm</td> <td>删除所有（停止状态的）服务容器</td></tr> <tr><td>run</td> <td>在指定服务上执行一个命令</td></tr> <tr><td>scale</td> <td>设置指定服务运行的容器个数</td></tr> <tr><td>start</td> <td>启动已经存在的服务容器</td></tr> <tr><td>stop</td> <td>停止已经处于运行状态的容器，但不删除它</td></tr> <tr><td>top</td> <td>显示运行的进程</td></tr> <tr><td>unpause</td> <td>恢复处于暂停状态中的服务</td></tr> <tr><td>up</td> <td>自动完成包括构建镜像、创建服务、启动服务并关闭关联服务相关容器的一些列操作</td></tr> <tr><td>version</td> <td>打印版本信息</td></tr></tbody></table> <p>1.up</p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose up [options] [--scale SERVICE=NUM...] [SERVICE...] 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>up命令十分强大，它尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一些列操作。链接的服务都将会被自动启动，除非已经处于运行状态。</p> <p>多数情况下我们可以直接通过该命令来启动一个项目。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-d 在后台运行服务容器 
–no-color 不使用颜色来区分不同的服务的控制输出 
–no-deps 不启动服务所链接的容器 
–force-recreate 强制重新创建容器，不能与–no-recreate同时使用 
–no-recreate 如果容器已经存在，则不重新创建，不能与–force-recreate同时使用 
–no-build 不自动构建缺失的服务镜像 
–build 在启动容器前构建服务镜像 
–abort-on-container-exit 停止所有容器，如果任何一个容器被停止，不能与-d同时使用 
-t, --timeout TIMEOUT 停止容器时候的超时（默认为10秒） 
–remove-orphans 删除服务中没有在compose文件中定义的容器 
–scale SERVICE=NUM 设置服务运行容器的个数，将覆盖在compose中通过scale指定的参数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>2. ps</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose ps [options] [SERVICE...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>列出项目中目前的所有容器。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-q 只打印容器的ID信息
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3. stop</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose stop [options] [SERVICE...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止已经处于运行状态的容器，但不删除它。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-t, --timeout TIMEOUT 停止容器时候的超时（默认为10秒）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. down</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose down [options]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止和删除容器、网络、卷、镜像，这些内容是通过docker-compose up命令创建的. 默认值删除 容器 网络，可以通过指定 rmi 、volumes参数删除镜像和卷。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>–rmi type 删除镜像，类型必须是: ‘all’: 删除compose文件中定义的所以镜像；‘local’: 删除镜像名为空的 镜像
-v, --volumes 删除已经在compose文件中定义的和匿名的附在容器上的数据卷 
–remove-orphans 删除服务中没有在compose中定义的容器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>5. restart</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose restart [options] [SERVICE...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>重启项目中的服务。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-t, --timeout TIMEOUT 指定重启前停止容器的超时（默认为10秒）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>6. rm</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose rm [options] [SERVICE...] 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除所有（停止状态的）服务容器。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>–f, --force 强制直接删除，包括非停止状态的容器 
-v 删除容器所挂载的数据卷
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>7. start</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose start [SERVICE...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>启动已经存在的服务容器。</p> <p><strong>8. run</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose run [options] [-v VOLUME...] [-p PORT...] [-e KEY=VAL...] SERVICE [COMMAND] [ARGS...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在指定服务上执行一个命令。</p> <p>例如：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose run ubuntu ping www.baidu.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将会执行一个ubuntu容器，并执行ping www.baidu.com命令。</p> <p>默认情况下，如果存在关联，则所有关联的服务将会自动被启动，除非这些服务已经在运行中。该命令类似于启动容</p> <p>器后运行指定的命令，相关卷、链接等都会按照配置自动创建。有两个不同点：</p> <ol><li>给定命令将会覆盖原有的自动运行命令</li> <li>不会自动创建端口，以避免冲突</li></ol> <p>如果不希望自动启动关联的容器，可以使用–no-deps选项，例如：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose run --no-deps web
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将不会启动web容器关联的其他容器</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-d 在后台运行服务容器 
–name NAME 为容器指定一个名字 
–entrypoint CMD 覆盖默认的容器启动指令 
-e KEY=VAL 设置环境变量值，可多次使用选项来设置多个环境变量
-u, --user=&quot;&quot; 指定运行容器的用户名或者uid
–no-deps 不自动启动管理的服务容器 
–rm 运行命令后自动删除容器，d模式下将忽略 
-p, --publish=[] 映射容器端口到本地主机 
–service-ports 配置服务端口并映射到本地主机 
-v, --volume=[] 绑定一个数据卷，默认为空 
-T 不分配伪tty，意味着依赖tty的指令将无法运行 
-w, --workdir=&quot;&quot; 为容器指定默认工作目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>9. confifig</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose config [options]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>验证并查看compose文件配置。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>–resolve-image-digests 将镜像标签标记为摘要 
-q, --quiet 只验证配置，不输出。 当配置正确时，不输出任何内容，当文件配置错误，输出错误信息 
–services 打印服务名，一行一个 
–volumes 打印数据卷名，一行一个
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>10. kill</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose kill [options] [SERVICE...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过发送SIGKILL信号来强制停止服务容器。 支持通过-s参数来指定发送的信号，例如：通过如下指令发送SIGINT信号：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose kill -s SIGINT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>11. create</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose create [options] [SERVICE...] 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>为服务创建容器.只是单纯的create，还需要使用start启动compose。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>–force-recreate 重新创建容器，即使它的配置和镜像没有改变，不兼容–no-recreate参数 
–no-recreate 如果容器已经存在，不需要重新创建. 不兼容–force-recreate参数 
–no-build 不创建镜像，即使缺失 
–build 创建容器前，生成镜像
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>12. exec</strong></p> <p>格式为：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>docker-compose exec [options] SERVICE COMMAND [ARGS...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与 docker exec 命令功能相同，可以通过service name登陆到容器中。</p> <p>选项包括：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>-d 分离模式，后台运行命令. 
–privileged 获取特权. 
–user USER 指定运行的用户. 
-T 禁用分配TTY. By default docker-compose exec分配 a TTY. 
–index=index 当一个服务拥有多个容器时，可通过该参数登陆到该服务下的任何服务，例如：docker-compose exec --index=1 web /bin/bash ，web服务中包含多个容器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="六、compose模版文件"><a href="#六、compose模版文件" class="header-anchor">#</a> 六、Compose模版文件</h2> <p>模板文件是使用Compose的核心，涉及的指令关键字也比较多，大部分指令与 docker run 相关参数的含义都是类似的。默认的模板文件名称为docker-compose.yml，格式为YAML格式。</p> <p>比如一个Compose模板文件：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>version: &quot;2&quot; 
	services: 
		web:
			images: nginx 
			ports: -&quot;8080:80&quot; 
			volumes: - /usr/local/abc:/usr/local/cba 
#volumes: 
#networks:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Docker Compose的模板文件主要分为3个区域，如下：</p> <ul><li>services
<ul><li>服务，在它下面可以定义应用需要的一些服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷、所属的网络、依赖哪些其他服务等等。</li></ul></li> <li>volumes
<ul><li>数据卷，在它下面可以定义的数据卷（名字等等），然后挂载到不同的服务下去使用。</li></ul></li> <li>networks
<ul><li>应用的网络，在它下面可以定义应用的名字、使用的网络类型等等。</li></ul></li></ul> <table><thead><tr><th><strong>指令</strong></th> <th><strong>功能</strong></th></tr></thead> <tbody><tr><td>build</td> <td>指定服务镜像Dockerfifile所在路径</td></tr> <tr><td>cap_dd，cap_drop</td> <td>指定容器的内核能力（capacity）分配</td></tr> <tr><td>command</td> <td>覆盖容器启动后默认执行的命令</td></tr> <tr><td>cgroup_parent</td> <td>指定父cgroup组，意味着将基础该组的资源限制</td></tr> <tr><td>container_name</td> <td>指定容器名称。默认将会使用项目名称服务名称序号这样的格式</td></tr> <tr><td>devices</td> <td>指定设置映射关系</td></tr> <tr><td>dns</td> <td>自定义DNS服务器。可以是一个值，也可以是一个列表</td></tr> <tr><td>dns_search</td> <td>配置DNS搜索域。可以是一个值，也可以是一个列表</td></tr> <tr><td>dockerfifile</td> <td>指定额外编译镜像的Dockerfifile文件，可以通过该指令来指定</td></tr> <tr><td>env_fifile</td> <td>从文件中获取环境变量，可以为单独的文件路径或列表</td></tr> <tr><td>environment</td> <td>设置环境变量，可以使用数组或字典两种格式</td></tr> <tr><td>expose</td> <td>暴露端口</td></tr> <tr><td>external_links</td> <td>链接到docker-compose.yml外部的容器，甚至可以是非Compose管理的外部容器</td></tr> <tr><td>extra_hosts</td> <td>指定额外的host名称映射信息</td></tr> <tr><td>image</td> <td>指定为镜像名称或镜像ID。如果镜像在本地不存在，Compose将会尝试拉取这个镜像</td></tr> <tr><td>labels</td> <td>指定服务镜像Dockerfifile所在路径</td></tr> <tr><td>links</td> <td>链接到其他服务中的容器</td></tr> <tr><td>log_driver</td> <td>指定日志驱动类型，类似于Docker中的–log-driver参数。目前支持三种日志驱动类型：log_driver:“json-fifile”、log_driver:“syslog”、log_driver:“none”</td></tr> <tr><td>log_opt</td> <td>日志驱动的相关参数</td></tr> <tr><td>net</td> <td>设置网络模式。参数类似于docker clinet的–net参数一样</td></tr> <tr><td>pid</td> <td>跟主机系统共享进程命名空间。打开该选项的容器之间，以及容器和宿主机系统之间可以通过进程ID来相互访问和操作</td></tr> <tr><td>ports</td> <td>暴露端口信息</td></tr> <tr><td>security_opt</td> <td>指定容器模板标签（label）机制的默认属性（如用户、角色、类型、级别等）</td></tr> <tr><td>ulimits</td> <td>指定容器的ulimits限制值</td></tr> <tr><td>volumes</td> <td>数据卷所挂载路径设置。可以设置宿主机路径（HOST:CONTAINER）或加上访问模式(HOST:CONTAINER:ro）</td></tr></tbody></table> <h2 id="七、compose应用"><a href="#七、compose应用" class="header-anchor">#</a> 七、Compose应用</h2> <p><strong>需求</strong>：编写compose模版文件，实现同时启动tomcat、mysql和redis容器。</p> <h4 id="_1、-编写模版文件"><a href="#_1、-编写模版文件" class="header-anchor">#</a> <strong>1、</strong> <strong>编写模版文件</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 创建文件夹</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /usr/local/mycompose 
<span class="token comment">#进入文件夹 </span>
<span class="token builtin class-name">cd</span> /usr/local/mycompose 
<span class="token comment">#创建 docker-compose.yml文件；内容如下 </span>
<span class="token function">vi</span> docker-compose.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>docker-compose.yml文件内容如下（文件内容请从 资料\配置文件\docker-compose.yml 复制）：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>version: '3'
services:
  redis1:
    image: redis
    ports:
      - &quot;6379:6379&quot;
    container_name: &quot;redis1&quot;
    networks: 
      - dev
  mysql1:
    image: centos/mysql-57-centos7
    environment:
      MYSQL_ROOT_PASSWORD: &quot;root&quot;
    ports: 
      - &quot;3306:3306&quot;
    container_name: &quot;mysql1&quot;
    networks: 
      - dev
  web1:
    image: tomcat
    ports: 
      - &quot;9090:8080&quot;
    container_name: &quot;web1&quot;
    networks: 
      - dev
      - pro
networks:
  dev:
    driver: bridge
  pro:
    driver: bridge
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>上面我们声明了3个服务；分别是：redis1、mysql1、web1；并且对3个服务都指定了对应的docker 镜像和端口。</p> <h4 id="_2、启动"><a href="#_2、启动" class="header-anchor">#</a> <strong>2</strong>、<strong>启动</strong></h4> <div class="language-text line-numbers-mode"><pre class="language-text"><code>#启动前最好把docker重启，不然原来的tomcat/mysql/redis容器也是启动状态的话，那么端口会冲突而启动失败 
systemctl restart docker 

cd /usr/local/mycompose 

docker-compose up 

# 如果后台启动则使用如下命令 
docker-compose up -d 

# 若要停止 
docker-compose stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>可以查看到命令中，创建了两个自定义的网络（mycompose_dev和mycompose_pro），然后创建容器，并「Attaching to …」，将网络应用到服务上。</p> <p>可以查看一下具体的网络，使用docker network ls 如下：</p> <p><img src="https://s2.loli.net/2022/12/01/1CjKForEBsTIU5z.png" alt="image-20220802030057950"></p> <p>查看启动的容器：</p> <p><img src="https://s2.loli.net/2022/12/01/6Kvc5TYGDNHJPjM.png" alt="image-20220802030034771"></p> <h4 id="_3、-测试"><a href="#_3、-测试" class="header-anchor">#</a> <strong>3、</strong> <strong>测试</strong></h4> <p>在windows下访问启动的3个服务进行测试都可以；如下面访问9090的tomcat如下：</p> <p><img src="https://s2.loli.net/2022/12/01/VRNZ23EkK4Q9IUW.png" alt="image-20220802030132427"></p> <h2 id="第三章-迁移备份仓库"><a href="#第三章-迁移备份仓库" class="header-anchor">#</a> 第三章 迁移备份仓库</h2> <p><img src="https://s2.loli.net/2022/12/01/SVQRvukP1NZsIBf.png" alt="image-20220802035604213"></p> <h3 id="一、迁移与备份"><a href="#一、迁移与备份" class="header-anchor">#</a> 一、迁移与备份</h3> <h4 id="_1、-将docker容器保存为镜像"><a href="#_1、-将docker容器保存为镜像" class="header-anchor">#</a> <strong>1、</strong> <strong>将</strong>Docker容器保存为镜像</h4> <p>使用docker commit命令可以将容器保存为镜像。</p> <p>命令形式：docker commit 容器名称 镜像名称</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 保存nginx容器为镜像 </span>
<span class="token function">docker</span> commit ydlcentos1 ydlcentos1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此镜像的内容就是当前容器的内容，接下来你可以用此镜像再次运行新的容器</p> <h4 id="_2、-镜像备份"><a href="#_2、-镜像备份" class="header-anchor">#</a> <strong>2、</strong> <strong>镜像备份</strong></h4> <p>使用docker save命令可以将已有镜像保存为tar 文件。</p> <p>命令形式：docker save –o tar文件名 镜像名</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code># 保存镜像为文件 
docker save -o ydlcentos1.tar ydlcentos1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/ezTZpMG6wqvtQ8b.png" alt="image-20220802032156887"></p> <h4 id="_3、-镜像恢复与迁移"><a href="#_3、-镜像恢复与迁移" class="header-anchor">#</a> <strong>3、</strong> <strong>镜像恢复与迁移</strong></h4> <p>使用docker load命令可以根据tar文件恢复为docker镜像。</p> <p>命令形式：docker load -i tar文件名</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code># 停止mynginx容器 
docker stop ydlcentos1 
# 删除mynginx容器 
docker rm ydlcentos1 
# 删除mynginx镜像 
docker rmi ydlcentos1 
# 加载恢复mynginx镜像 
docker load -i ydlcentos1.tar 
# 在镜像恢复之后，基于该镜像再次创建启动容器 
docker run -di --name=ydlcentos1 ydlcentos1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意：在执行docker load命令恢复镜像时，需要先删除原镜像。</p> <h3 id="二、-使用dockerfile创建镜像-根据我们的流程-制作镜像"><a href="#二、-使用dockerfile创建镜像-根据我们的流程-制作镜像" class="header-anchor">#</a> 二、 使用Dockerfile创建镜像（根据我们的流程 制作镜像）</h3> <h4 id="_1、-什么是dockerfile文件"><a href="#_1、-什么是dockerfile文件" class="header-anchor">#</a> <strong>1、</strong> <strong>什么是</strong>Dockerfile文件</h4> <p>前面的课程中已经知道了，要获得镜像，可以从Docker仓库中进行下载。那如果我们想自己开发一个镜像，那该如何做呢？答案是：Dockerfifile</p> <p>Dockerfifile其实就是一个文本文件，由一系列命令和参数构成，Docker可以读取Dockerfifile文件并根据Dockerfifile文件的描述来构建镜像。</p> <p>Dockerfifile文件内容一般分为4部分：</p> <ul><li>基础镜像信息</li> <li>维护者信息</li> <li>镜像操作指令</li> <li>容器启动时执行的指令</li></ul> <h4 id="_2、dockerfifile常用命令"><a href="#_2、dockerfifile常用命令" class="header-anchor">#</a> 2、Dockerfifile常用命令</h4> <p>Dockerfile可以基于镜像制作镜像；<code>docker build -t='jdk1.8' .</code></p> <table><thead><tr><th>关键字</th> <th>作用</th> <th>备注</th></tr></thead> <tbody><tr><td>FROM</td> <td>指定父镜像</td> <td>指定dockerfile基于那个image构建</td></tr> <tr><td>MAINTAINER</td> <td>作者信息</td> <td>用来标明这个dockerfile谁写的</td></tr> <tr><td>LABEL</td> <td>标签</td> <td>用来标明dockerfile的标签 可以使用Label代替Maintainer 最终都是在docker image基本信息中可以查看</td></tr> <tr><td>RUN</td> <td>执行命令</td> <td>执行一段命令 默认是/bin/sh 格式: RUN command 或者 RUN [&quot;command&quot; , &quot;param1&quot;,&quot;param2&quot;]</td></tr> <tr><td>CMD</td> <td>容器启动命令</td> <td>提供启动容器时候的默认命令 和ENTRYPOINT配合使用.格式 CMD command param1 param2 或者 CMD [&quot;command&quot; , &quot;param1&quot;,&quot;param2&quot;]</td></tr> <tr><td>ENTRYPOINT</td> <td>入口</td> <td>一般在制作一些执行就关闭的容器中会使用</td></tr> <tr><td>COPY</td> <td>复制文件</td> <td>build的时候复制文件到image中</td></tr> <tr><td>ADD</td> <td>添加文件</td> <td>build的时候添加文件到image中 不仅仅局限于当前build上下文 可以来源于远程服务</td></tr> <tr><td>ENV</td> <td>环境变量</td> <td>指定build时候的环境变量 可以在启动的容器的时候 通过-e覆盖 格式ENV name=value</td></tr> <tr><td>ARG</td> <td>构建参数</td> <td>构建参数 只在构建的时候使用的参数 如果有ENV 那么ENV的相同名字的值始终覆盖arg的参数</td></tr> <tr><td>VOLUME</td> <td>定义外部可以挂载的数据卷</td> <td>指定build的image那些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 -v 绑定 格式 VOLUME [&quot;目录&quot;]</td></tr> <tr><td>EXPOSE</td> <td>暴露端口</td> <td>定义容器运行的时候监听的端口 启动容器的使用-p来绑定暴露端口 格式: EXPOSE 8080 或者 EXPOSE 8080/udp</td></tr> <tr><td>WORKDIR</td> <td>工作目录</td> <td>指定容器内部的工作目录 如果没有创建则自动创建 如果指定/ 使用的是绝对地址 如果不是/开头那么是在上一条workdir的路径的相对路径</td></tr> <tr><td>USER</td> <td>指定执行用户</td> <td>指定build或者启动的时候 用户 在RUN CMD ENTRYPONT执行的时候的用户</td></tr> <tr><td>HEALTHCHECK</td> <td>健康检查</td> <td>指定监测当前容器的健康监测的命令 基本上没用 因为很多时候 应用本身有健康监测机制</td></tr> <tr><td>ONBUILD</td> <td>触发器</td> <td>当存在ONBUILD关键字的镜像作为基础镜像的时候 当执行FROM完成之后 会执行 ONBUILD的命令 但是不影响当前镜像 用处也不怎么大</td></tr> <tr><td>STOPSIGNAL</td> <td>发送信号量到宿主机</td> <td>该STOPSIGNAL指令设置将发送到容器的系统调用信号以退出。</td></tr> <tr><td>SHELL</td> <td>指定执行脚本的shell</td> <td>指定RUN CMD ENTRYPOINT 执行命令的时候 使用的shell</td></tr></tbody></table> <h4 id="_3、-使用dockerfile创建镜像"><a href="#_3、-使用dockerfile创建镜像" class="header-anchor">#</a> <strong>3、</strong> <strong>使用Dockerfile创建镜像</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1、创建目录 </span>
<span class="token function">mkdir</span> –p /usr/local/dockerjdk8 
<span class="token builtin class-name">cd</span> /usr/local/dockerjdk8 


rz <span class="token parameter variable">-be</span>  <span class="token comment">#上传</span>
<span class="token comment"># 2、下载jdk-8u231-linux-x64.tar.gz并上传到服务器（虚拟机）中的/usr/local/dockerjdk8目录 </span>

<span class="token comment"># 3、在/usr/local/dockerjdk8目录下创建Dockerfile文件，文件内容如下： </span>
<span class="token function">vi</span> Dockerfile 

FROM centos:7 
MAINTAINER ITLILS 
WORKDIR /usr 
RUN <span class="token function">mkdir</span> /usr/local/java 
ADD jdk-8u231-linux-x64.tar.gz /usr/local/java/ 
ENV JAVA_HOME /usr/local/java/jdk1.8.0_231 
ENV JRE_HOME <span class="token variable">$JAVA_HOME</span>/jre 
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar:<span class="token variable">$JRE_HOME</span>/lib:<span class="token variable">$CLASSPATH</span> 
ENV <span class="token environment constant">PATH</span> <span class="token variable">$JAVA_HOME</span>/bin:<span class="token environment constant">$PATH</span> 

<span class="token comment"># 4、执行命令构建镜像；不要忘了后面的那个 . </span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span><span class="token operator">=</span><span class="token string">'jdk1.8'</span> <span class="token builtin class-name">.</span> 

<span class="token comment"># 5、查看镜像是否建立完成 </span>
<span class="token function">docker</span> images






FROM ubuntu
MAINTAINER QJJTest
WORKDIR /usr 
<span class="token comment">#java</span>
RUN <span class="token function">mkdir</span> /usr/local/java 
ADD jdk-8u333-linux-x64.tar.gz /usr/local/java/ 
ENV JAVA_HOME /usr/local/java/jdk1.8.0_333 
ENV JRE_HOME <span class="token variable">$JAVA_HOME</span>/jre 
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar:<span class="token variable">$JRE_HOME</span>/lib:<span class="token variable">$CLASSPATH</span> 
ENV <span class="token environment constant">PATH</span> <span class="token variable">$JAVA_HOME</span>/bin:<span class="token environment constant">$PATH</span> 

<span class="token comment">#加入项目</span>
RUN <span class="token function">mkdir</span> /usr/bin/project
ADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar
EXPOSE <span class="token number">8888</span>
ENTRYPOINT <span class="token function">java</span> <span class="token parameter variable">-jar</span> /usr/bin/project/app.jar

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>






FROM jdk1.8
MAINTAINER QJJTest
WORKDIR /usr 

<span class="token comment">#加入项目</span>
RUN <span class="token function">mkdir</span> /usr/bin/project
ADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar
EXPOSE <span class="token number">8888</span>
EXNTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span> ,<span class="token string">&quot;&quot;</span>-jar<span class="token string">&quot; ,&quot;</span>&quot;/usr/bin/project/app.jar&quot;<span class="token punctuation">]</span>




<span class="token comment"># 启动镜像</span>
<span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8089</span>:8888 <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span>java_project_net <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span> mycompose_dev <span class="token punctuation">\</span>
java_project

<span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8088</span>:8888 <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span>project_test2_net <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span> mycompose_dev <span class="token punctuation">\</span>
project_test2


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/oSVBWys42aZwmJQ.png" alt="image-20220802034204602"></p> <h4 id="_4、-基于镜像创建容器"><a href="#_4、-基于镜像创建容器" class="header-anchor">#</a> <strong>4、</strong> <strong>基于镜像创建容器</strong></h4> <p>基于刚刚创建的镜像 jdk1.8 创建并启动容器进行测试；</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 创建并启动容器 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>testjdk jdk1.8 /bin/bash 
<span class="token comment"># 在容器中测试jdk是否已经安装 </span>
<span class="token function">java</span> <span class="token parameter variable">-version</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://s2.loli.net/2022/12/01/NSopiwTCxJ69u7Z.png" alt="image-20220802034313026"></p> <p><strong>作业：</strong></p> <ol><li>boot 一个controller 访问/test,返回“hello yuandongli!”</li> <li>打成jar包，使用Dockerfile，centos:7为底构建一个镜像，起起来，可以访问到8080/test,返回“hello yuandongli!”</li></ol> <h1 id="命令总结"><a href="#命令总结" class="header-anchor">#</a> 命令总结</h1> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># step 1: 安装必要的一些系统工具</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> apt-transport-https ca-certificates <span class="token function">curl</span> software-properties-common
<span class="token comment"># step 2: 安装GPG证书</span>
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -
<span class="token comment"># Step 3: 写入软件源信息</span>
<span class="token function">sudo</span> add-apt-repository <span class="token string">&quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> stable&quot;</span>
<span class="token comment"># Step 4: 更新并安装 Docker-CE</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> docker-ce

<span class="token comment"># 4、 安装docker；出现输入的界面都按 y </span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce
<span class="token comment"># 5、 查看docker版本 </span>
<span class="token function">docker</span> <span class="token parameter variable">-v</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>1、 编辑文件/etc/docker/daemon.json</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 执行如下命令： </span>
<span class="token function">mkdir</span> /etc/docker 
<span class="token function">vi</span> /etc/docker/daemon.json <span class="token punctuation">(</span>daemon.conf<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、在文件中加入下面内容</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span>
<span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
	<span class="token string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>,
	<span class="token string">&quot;http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo&quot;</span>,
	<span class="token string">&quot;https://mirror.ccs.tencentyun.com&quot;</span>
<span class="token punctuation">]</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Docker启动与停止命令</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 启动docker服务： </span>
systemctl start <span class="token function">docker</span> 
<span class="token comment"># 停止docker服务： </span>
systemctl stop <span class="token function">docker</span> 
<span class="token comment"># 重启docker服务： </span>
systemctl restart <span class="token function">docker</span> 
<span class="token comment"># 查看docker服务状态： </span>
systemctl status <span class="token function">docker</span> 
<span class="token comment"># 设置开机启动docker服务： </span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#创建并启动守护式容器 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-di</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>ydlcentos2 centos:7 
<span class="token comment">#登录进入容器命令为：docker exec -it container_name (或者 container_id) /bin/bash（exit退出 时，容器不会停止） </span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> ydlcentos2 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h2> <h3 id="docker-compose简介-安装-用来创建容器"><a href="#docker-compose简介-安装-用来创建容器" class="header-anchor">#</a> docker-compose简介&amp;安装 		(用来创建容器)</h3> <h4 id="概念"><a href="#概念" class="header-anchor">#</a> <strong>概念</strong></h4> <p>Compose项目是Docker官方的开源项目，负责实现对Docker容器集群的快速编排。它<strong>是一个定义和运行多容器的</strong>docker应用工具。使用compose，你能通过YMAL文件配置你自己的服务，然后通过一个命令，你能使用配置文件创建和运行所有的服务。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token string">&quot;https://github.com/docker/compose/releases/download/1.24.0/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">)</span></span>&quot;</span> <span class="token parameter variable">-o</span> /usr/local/bin/docker-compose 

<span class="token comment"># 设置文件可执行权限 </span>
<span class="token function">chmod</span> +x /usr/local/bin/docker-compose 

<span class="token comment"># 查看版本信息 </span>
<span class="token function">docker-compose</span> <span class="token parameter variable">-version</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="compose应用"><a href="#compose应用" class="header-anchor">#</a> Compose应用</h3> <p><strong>需求</strong>：编写compose模版文件，实现同时启动tomcat、mysql和redis容器。</p> <h4 id="编写模版文件"><a href="#编写模版文件" class="header-anchor">#</a> <strong>编写模版文件</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 创建文件夹</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /usr/local/mycompose 
<span class="token comment">#进入文件夹 </span>
<span class="token builtin class-name">cd</span> /usr/local/mycompose 
<span class="token comment">#创建 docker-compose.yml文件；内容如下 </span>
<span class="token function">vi</span> docker-compose.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>docker-compose.yml文件内容如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>version: <span class="token string">'3'</span>
services:
  redis1:
    image: redis
    ports:
      - <span class="token string">&quot;6379:6379&quot;</span>
    container_name: <span class="token string">&quot;redis1&quot;</span>
    networks: 
      - dev
  mysql1:
    image: centos/mysql-57-centos7
    environment:
      MYSQL_ROOT_PASSWORD: <span class="token string">&quot;root&quot;</span>
    ports: 
      - <span class="token string">&quot;3306:3306&quot;</span>
    container_name: <span class="token string">&quot;mysql1&quot;</span>
    networks: 
      - dev
  web1:
    image: tomcat
    ports: 
      - <span class="token string">&quot;9090:8080&quot;</span>
    container_name: <span class="token string">&quot;web1&quot;</span>
    networks: 
      - dev
      - pro
networks:
  dev:
    driver: bridge
  pro:
    driver: bridge
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>上面我们声明了3个服务；分别是：redis1、mysql1、web1；并且对3个服务都指定了对应的docker 镜像和端口。</p> <h4 id="启动"><a href="#启动" class="header-anchor">#</a> <strong>启动</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#启动前最好把docker重启，不然原来的tomcat/mysql/redis容器也是启动状态的话，那么端口会冲突而启动失败 </span>
systemctl restart <span class="token function">docker</span> 

<span class="token builtin class-name">cd</span> /usr/local/mycompose 

<span class="token function">docker-compose</span> up 

<span class="token comment"># 如果后台启动则使用如下命令 </span>
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span> 

<span class="token comment"># 若要停止 </span>
<span class="token function">docker-compose</span> stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="使用dockerfile创建镜像-根据我们的流程-制作镜像"><a href="#使用dockerfile创建镜像-根据我们的流程-制作镜像" class="header-anchor">#</a> 使用Dockerfile创建镜像（根据我们的流程 制作镜像）</h3> <h4 id="_1、-什么是dockerfile文件-2"><a href="#_1、-什么是dockerfile文件-2" class="header-anchor">#</a> <strong>1、</strong> <strong>什么是</strong>Dockerfile文件</h4> <p>前面的课程中已经知道了，要获得镜像，可以从Docker仓库中进行下载。那如果我们想自己开发一个镜像，那该如何做呢？答案是：Dockerfifile</p> <p>Dockerfifile其实就是一个文本文件，由一系列命令和参数构成，Docker可以读取Dockerfifile文件并根据Dockerfifile文件的描述来构建镜像。</p> <p>Dockerfifile文件内容一般分为4部分：</p> <ul><li>基础镜像信息</li> <li>维护者信息</li> <li>镜像操作指令</li> <li>容器启动时执行的指令</li></ul> <h4 id="_2、dockerfifile常用命令-2"><a href="#_2、dockerfifile常用命令-2" class="header-anchor">#</a> 2、Dockerfifile常用命令</h4> <p>Dockerfile可以基于镜像制作镜像；<code>docker build -t='jdk1.8' .</code></p> <table><thead><tr><th>关键字</th> <th>作用</th> <th>备注</th></tr></thead> <tbody><tr><td>FROM</td> <td>指定父镜像</td> <td>指定dockerfile基于那个image构建</td></tr> <tr><td>MAINTAINER</td> <td>作者信息</td> <td>用来标明这个dockerfile谁写的</td></tr> <tr><td>LABEL</td> <td>标签</td> <td>用来标明dockerfile的标签 可以使用Label代替Maintainer 最终都是在docker image基本信息中可以查看</td></tr> <tr><td>RUN</td> <td>执行命令</td> <td>执行一段命令 默认是/bin/sh 格式: RUN command 或者 RUN [&quot;command&quot; , &quot;param1&quot;,&quot;param2&quot;]</td></tr> <tr><td>CMD</td> <td>容器启动命令</td> <td>提供启动容器时候的默认命令 和ENTRYPOINT配合使用.格式 CMD command param1 param2 或者 CMD [&quot;command&quot; , &quot;param1&quot;,&quot;param2&quot;]</td></tr> <tr><td>ENTRYPOINT</td> <td>入口</td> <td>一般在制作一些执行就关闭的容器中会使用</td></tr> <tr><td>COPY</td> <td>复制文件</td> <td>build的时候复制文件到image中</td></tr> <tr><td>ADD</td> <td>添加文件</td> <td>build的时候添加文件到image中 不仅仅局限于当前build上下文 可以来源于远程服务</td></tr> <tr><td>ENV</td> <td>环境变量</td> <td>指定build时候的环境变量 可以在启动的容器的时候 通过-e覆盖 格式ENV name=value</td></tr> <tr><td>ARG</td> <td>构建参数</td> <td>构建参数 只在构建的时候使用的参数 如果有ENV 那么ENV的相同名字的值始终覆盖arg的参数</td></tr> <tr><td>VOLUME</td> <td>定义外部可以挂载的数据卷</td> <td>指定build的image那些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 -v 绑定 格式 VOLUME [&quot;目录&quot;]</td></tr> <tr><td>EXPOSE</td> <td>暴露端口</td> <td>定义容器运行的时候监听的端口 启动容器的使用-p来绑定暴露端口 格式: EXPOSE 8080 或者 EXPOSE 8080/udp</td></tr> <tr><td>WORKDIR</td> <td>工作目录</td> <td>指定容器内部的工作目录 如果没有创建则自动创建 如果指定/ 使用的是绝对地址 如果不是/开头那么是在上一条workdir的路径的相对路径</td></tr> <tr><td>USER</td> <td>指定执行用户</td> <td>指定build或者启动的时候 用户 在RUN CMD ENTRYPONT执行的时候的用户</td></tr> <tr><td>HEALTHCHECK</td> <td>健康检查</td> <td>指定监测当前容器的健康监测的命令 基本上没用 因为很多时候 应用本身有健康监测机制</td></tr> <tr><td>ONBUILD</td> <td>触发器</td> <td>当存在ONBUILD关键字的镜像作为基础镜像的时候 当执行FROM完成之后 会执行 ONBUILD的命令 但是不影响当前镜像 用处也不怎么大</td></tr> <tr><td>STOPSIGNAL</td> <td>发送信号量到宿主机</td> <td>该STOPSIGNAL指令设置将发送到容器的系统调用信号以退出。</td></tr> <tr><td>SHELL</td> <td>指定执行脚本的shell</td> <td>指定RUN CMD ENTRYPOINT 执行命令的时候 使用的shell</td></tr></tbody></table> <h4 id="_3、-使用dockerfile创建镜像-2"><a href="#_3、-使用dockerfile创建镜像-2" class="header-anchor">#</a> <strong>3、</strong> <strong>使用Dockerfile创建镜像</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1、创建目录 </span>
<span class="token function">mkdir</span> –p /usr/local/dockerjdk8 
<span class="token builtin class-name">cd</span> /usr/local/dockerjdk8 


rz <span class="token parameter variable">-be</span>  <span class="token comment">#上传</span>
<span class="token comment"># 2、下载jdk-8u231-linux-x64.tar.gz并上传到服务器（虚拟机）中的/usr/local/dockerjdk8目录 </span>

<span class="token comment"># 3、在/usr/local/dockerjdk8目录下创建Dockerfile文件，文件内容如下： </span>
<span class="token function">vi</span> Dockerfile 

FROM centos:7 
MAINTAINER ITLILS 
WORKDIR /usr 
RUN <span class="token function">mkdir</span> /usr/local/java 
ADD jdk-8u231-linux-x64.tar.gz /usr/local/java/ 
ENV JAVA_HOME /usr/local/java/jdk1.8.0_231 
ENV JRE_HOME <span class="token variable">$JAVA_HOME</span>/jre 
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar:<span class="token variable">$JRE_HOME</span>/lib:<span class="token variable">$CLASSPATH</span> 
ENV <span class="token environment constant">PATH</span> <span class="token variable">$JAVA_HOME</span>/bin:<span class="token environment constant">$PATH</span> 

<span class="token comment"># 4、执行命令构建镜像；不要忘了后面的那个 . </span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span><span class="token operator">=</span><span class="token string">'jdk1.8'</span> <span class="token builtin class-name">.</span> 

<span class="token comment"># 5、查看镜像是否建立完成 </span>
<span class="token function">docker</span> images





<span class="token comment">#案例 使用ubuntu作为底层 创建java镜像 同时运行jar项目</span>
FROM ubuntu
MAINTAINER QJJTest
WORKDIR /usr 
<span class="token comment">#java</span>
RUN <span class="token function">mkdir</span> /usr/local/java 
ADD jdk-8u333-linux-x64.tar.gz /usr/local/java/ 
ENV JAVA_HOME /usr/local/java/jdk1.8.0_333 
ENV JRE_HOME <span class="token variable">$JAVA_HOME</span>/jre 
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar:<span class="token variable">$JRE_HOME</span>/lib:<span class="token variable">$CLASSPATH</span> 
ENV <span class="token environment constant">PATH</span> <span class="token variable">$JAVA_HOME</span>/bin:<span class="token environment constant">$PATH</span> 
<span class="token comment">#加入项目</span>
RUN <span class="token function">mkdir</span> /usr/bin/project
ADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar
EXPOSE <span class="token number">8888</span>
ENTRYPOINT <span class="token function">java</span> <span class="token parameter variable">-jar</span> /usr/bin/project/app.jar

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

<span class="token comment">#以 Java为底包 创建 jar(我们自己项目) 镜像</span>
FROM jdk1.8
MAINTAINER QJJTest
WORKDIR /usr 
<span class="token comment">#加入项目</span>
RUN <span class="token function">mkdir</span> /usr/bin/project
ADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar
<span class="token comment">#暴露端口</span>
EXPOSE <span class="token number">8888</span>
<span class="token comment">#执行命令</span>
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span> ,<span class="token string">&quot;&quot;</span>-jar<span class="token string">&quot; ,&quot;</span>&quot;/usr/bin/project/app.jar&quot;<span class="token punctuation">]</span>




<span class="token comment"># 通过镜像文件 创建容器</span>
<span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8089</span>:8888 <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span>java_project_net <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span> mycompose_dev <span class="token punctuation">\</span>
java_project

<span class="token function">docker</span> run <span class="token parameter variable">-id</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8088</span>:8888 <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span>project_test2_net <span class="token punctuation">\</span>
<span class="token parameter variable">--network</span> mycompose_dev <span class="token punctuation">\</span>
project_test2

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h4 id=""><a href="#" class="header-anchor">#</a></h4> <h4 id="_4、-基于镜像创建容器-2"><a href="#_4、-基于镜像创建容器-2" class="header-anchor">#</a> <strong>4、</strong> <strong>基于镜像创建容器</strong></h4> <p>基于刚刚创建的镜像 jdk1.8 创建并启动容器进行测试；</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 创建并启动容器 </span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span><span class="token operator">=</span>testjdk jdk1.8 /bin/bash 
<span class="token comment"># 在容器中测试jdk是否已经安装 </span>
<span class="token function">java</span> <span class="token parameter variable">-version</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/#/edit/master/docs/06.技术笔记/01.docker/01.Docker.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/12/10, 09:06:09</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/9100eb/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Redis</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/9100eb/">Redis</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/23dd8b/"><div>
            RabbitMqDemo
            <!----></div></a> <span class="date">09-12</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/dc92ff/"><div>
            ElasticsearchLinux下环境搭建
            <!----></div></a> <span class="date">09-12</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/ba54ad/"><div>
            Docker
            <!----></div></a> <span class="date">02-27</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2023
    <span>船到桥头沉 | <a href="https://github.com/NewStudyAccount/vblog/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.87eabd22.js" defer></script><script src="/assets/js/2.3f274d60.js" defer></script><script src="/assets/js/41.ab55b8a0.js" defer></script>
  </body>
</html>
