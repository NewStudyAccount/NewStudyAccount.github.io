(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{348:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("h2",{attrs:{id:"第一章-docker-介绍-运维工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一章-docker-介绍-运维工具"}},[s._v("#")]),s._v(" 第一章 Docker 介绍 - 运维工具")]),s._v(" "),a("h3",{attrs:{id:"一、docker概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、docker概述"}},[s._v("#")]),s._v(" 一、Docker概述")]),s._v(" "),a("p",[s._v("java--\x3ejar 运行开发环境 mysql5.7")]),s._v(" "),a("p",[s._v("jar---\x3e生产环境 出错了！ mysql8")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801153532910.4ecac8d4.png",alt:"image-20220801153532910"}})]),s._v(" "),a("p",[s._v("Docker 是一个开源的"),a("strong",[s._v("应用容器引擎")]),s._v("，基于 Go 语言开发。Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。")]),s._v(" "),a("p",[a("strong",[s._v("Docker应用场景")])]),s._v(" "),a("ul",[a("li",[s._v("Web 应用的自动化打包和发布")]),s._v(" "),a("li",[s._v("自动化测试和持续集成、发布")]),s._v(" "),a("li",[s._v("在服务型环境中部署和调整数据库或其他的后台应用")])]),s._v(" "),a("p",[s._v("使用Docker可以实现开发人员的开发环境、测试人员的测试环境、运维人员的生产环境的一致性。")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801152413424.1a6ba897.png",alt:"image-20220801152413424"}})]),s._v(" "),a("h3",{attrs:{id:"二、docker组成部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、docker组成部分"}},[s._v("#")]),s._v(" 二、Docker组成部分")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801161305417.031d6da6.png",alt:"image-20220801161305417"}})]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("名称")])]),s._v(" "),a("th",[a("strong",[s._v("说明")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("Docker 镜像(Images)")]),s._v(" "),a("td",[s._v("Docker 镜像是用于创建 Docker 容器的模板。 镜像是基于联合文件系统的一种层式结构，由一系列指令一步一步构建出来。")])]),s._v(" "),a("tr",[a("td",[s._v("Docker 容器(Container)")]),s._v(" "),a("td",[s._v("容器是独立运行的一个或一组应用。镜像相当于类，容器相当于类的实例")])]),s._v(" "),a("tr",[a("td",[s._v("Docker 客户端(Client)")]),s._v(" "),a("td",[s._v("Docker 客户端通过命令行或者其他工具使用 Docker API 与 Docker 的守护进程通信")])]),s._v(" "),a("tr",[a("td",[s._v("Docker 主机(Host)")]),s._v(" "),a("td",[s._v("一个物理或者虚拟的机器用于执行 Docker 守护进程和容器。")])]),s._v(" "),a("tr",[a("td",[s._v("Docker守护进程")]),s._v(" "),a("td",[s._v("是Docker服务器端进程，负责支撑Docker 容器的运行以及镜像的管理。")])]),s._v(" "),a("tr",[a("td",[s._v("Docker 仓库DockerHub (Registry)")]),s._v(" "),a("td",[s._v("Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。 Docker Hub提供了庞大的镜像集合供使用。用户也可以将自己本地的镜像推送到Docker仓库供其他人下载。")])])])]),s._v(" "),a("h3",{attrs:{id:"三、导入元动力虚拟机镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、导入元动力虚拟机镜像"}},[s._v("#")]),s._v(" 三、导入元动力虚拟机镜像")]),s._v(" "),a("p",[s._v("将资源中的虚拟机进行安装（相关的docker容器安装已经安装完毕,注意号段改为200）")]),s._v(" "),a("p",[s._v("补充：虚拟机：复制了？选"),a("strong",[s._v("移动")]),s._v("了？")]),s._v(" "),a("p",[s._v("同户名：root")]),s._v(" "),a("p",[s._v("密码：ydl666")]),s._v(" "),a("p",[s._v("ifconfig 显示ip")]),s._v(" "),a("p",[s._v("导入虚拟机：注意修改相关号段")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801165505855.fc56eea7.png",alt:"image-20220801165505855"}})]),s._v(" "),a("h4",{attrs:{id:"_1、修改vmware-vmnet8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改vmware-vmnet8"}},[s._v("#")]),s._v(" 1、修改vmware vmnet8")]),s._v(" "),a("p",[s._v("子网IP:192.168.246.0")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801165549232.1af12984.png",alt:"image-20220801165549232"}})]),s._v(" "),a("p",[s._v("DHCP设置：起始结束号段 246")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801165628810.a983ccd5.png",alt:"image-20220801165628810"}})]),s._v(" "),a("p",[s._v("NAT设置：网关 192.168.246.2")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801165650845.a017c878.png",alt:"image-20220801165650845"}})]),s._v(" "),a("h4",{attrs:{id:"_2、修改本机vmnet8-地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、修改本机vmnet8-地址"}},[s._v("#")]),s._v(" 2、修改本机vmnet8 地址")]),s._v(" "),a("p",[s._v("右键网络打开共享中心")]),s._v(" "),a("p",[s._v("修改适配器设置")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/2020-04-05-11-32-12-image.f586abdb.png",alt:"img"}})]),s._v(" "),a("ul",[a("li",[s._v("vnet8网卡 右键 属性")]),s._v(" "),a("li",[s._v("ipv4协议 修改")]),s._v(" "),a("li",[s._v("本机IP 192.168.246.1")]),s._v(" "),a("li",[s._v("网关 192.168.246.2")]),s._v(" "),a("li",[s._v("dns 192.168.246.2")])]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801170000634.a522f4d5.png",alt:"image-20220801170000634"}})]),s._v(" "),a("h4",{attrs:{id:"_3、启动虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、启动虚拟机"}},[s._v("#")]),s._v(" 3、启动虚拟机")]),s._v(" "),a("p",[s._v("root")]),s._v(" "),a("p",[s._v("ydl666")]),s._v(" "),a("h4",{attrs:{id:"_4、xshell-crt-finalshell连接到虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、xshell-crt-finalshell连接到虚拟机"}},[s._v("#")]),s._v(" 4、xshell crt finalshell连接到虚拟机")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801170133621.cfad42d2.png",alt:"image-20220801170133621"}})]),s._v(" "),a("p",[s._v("连接成功！")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801170236614.10369883.png",alt:"image-20220801170236614"}})]),s._v(" "),a("h3",{attrs:{id:"四、docker安装与启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、docker安装与启动"}},[s._v("#")]),s._v(" 四、Docker安装与启动")]),s._v(" "),a("p",[s._v("Docker可以运行在MAC、Windows、CentOS、DEBIAN、UBUNTU等操作系统上，提供社区版和企业版，本课程基于CentOS安装Docker。CentOS6对docker支持的不好，使用docker建议使用CentOS7。")]),s._v(" "),a("p",[s._v("以下是在Ubuntu中安装Docker的步骤：")]),s._v(" "),a("p",[a("strong",[s._v("ubuntu软件默认安装位置")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、下载的软件存放位置\n/var/cache/apt/archives\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、安装后软件默认位置\n/usr/share\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、可执行文件位置\n/usr/bin\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、配置文件位置\n/etc\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、lib文件位置\n /usr/lib\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("hr"),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step 1: 安装必要的一些系统工具")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apt-transport-https ca-certificates "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" software-properties-common\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step 2: 安装GPG证书")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 3: 写入软件源信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" add-apt-repository "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-cs")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(' stable"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 4: 更新并安装 Docker-CE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、 安装docker；出现输入的界面都按 y ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" docker-ce\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、 查看docker版本 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[a("strong",[s._v("设置ustc镜像")])]),s._v(" "),a("p",[s._v("ustc是老牌的linux镜像服务提供者了，还在遥远的ubuntu 5.04版本的时候就在用。ustc的docker镜像加速器速度很快。ustc docker mirror的优势之一就是不需要注册，是真正的公共服务。")]),s._v(" "),a("p",[s._v("1、 编辑文件/etc/docker/daemon.json")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行如下命令： ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/docker \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("daemon.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("2、在文件中加入下面内容")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不能出现空格")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://mirror.ccs.tencentyun.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("Docker启动与停止命令")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 启动docker服务： \nsystemctl start docker \n# 停止docker服务： \nsystemctl stop docker \n# 重启docker服务： \nsystemctl restart docker \n# 查看docker服务状态： \nsystemctl status docker \n# 设置开机启动docker服务： \nsystemctl enable docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801172055300.88ac4313.png",alt:"image-20220801172055300"}})]),s._v(" "),a("h3",{attrs:{id:"五、镜像相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、镜像相关命令"}},[s._v("#")]),s._v(" 五、镜像相关命令")]),s._v(" "),a("p",[a("strong",[s._v("镜像")]),s._v("：Docker镜像是由文件系统叠加而成（是一种文件的存储形式）；是docker中的核心概念，可以认为镜像就是对某些运行环境或者软件打的包，用户可以从docker仓库中下载基础镜像到本地，比如开发人员可以从docker仓库拉取（下载）一个只包含centos7系统的基础镜像，然后在这个镜像中安装jdk、mysql、Tomcat和自己开发的应用，最后将这些环境打成一个新的镜像。开发人员将这个新的镜像提交给测试人员进行测试，测试人员只需要在测试环境下运行这个镜像就可以了，这样就可以保证开发人员的环境和测试人员的环境完全一致。")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220801154638733.b17c9634.png",alt:"image-20220801154638733"}})]),s._v(" "),a("h4",{attrs:{id:"_1、查看本地镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、查看本地镜像"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、查看本地镜像")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 查看镜像可以使用如下命令： \ndocker images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802004512134.e251414d.png",alt:"image-20220802004512134"}})]),s._v(" "),a("p",[s._v("REPOSITORY：镜像名称")]),s._v(" "),a("p",[s._v("TAG：镜像标签")]),s._v(" "),a("p",[s._v("IMAGE ID：镜像ID")]),s._v(" "),a("p",[s._v("CREATED：镜像的创建日期")]),s._v(" "),a("p",[s._v("SIZE：镜像大小")]),s._v(" "),a("h4",{attrs:{id:"_2、搜索镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、搜索镜像"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2、搜索镜像")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 如果你需要从网络中查找需要的镜像，可以通过以下命令搜索 \ndocker search 镜像名称\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802004640991.11e1bf8d.png",alt:"image-20220802004640991"}})]),s._v(" "),a("p",[s._v("NAME：镜像名称")]),s._v(" "),a("p",[s._v("DESCRIPTION：镜像描述")]),s._v(" "),a("p",[s._v("STARS：用户评价，反应一个镜像的受欢迎程度")]),s._v(" "),a("p",[s._v("OFFICIAL：是否官方")]),s._v(" "),a("p",[s._v("AUTOMATED：自动构建，表示该镜像由Docker Hub自动构建流程创建的")]),s._v(" "),a("h4",{attrs:{id:"_3、拉取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、拉取镜像"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、拉取镜像")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 拉取镜像就是从Docker仓库下载镜像到本地，镜像名称格式为 名称:版本号，如果版本号不指定则是最新的版本 命令如下： d\nocker pull 镜像名称 \n# 如拉取centos 7； \ndocker pull centos:7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802005024899.7a43f24d.png",alt:"image-20220802005024899"}})]),s._v(" "),a("h4",{attrs:{id:"_4、删除镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、删除镜像"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4、删除镜像")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 可以按照镜像id删除镜像，命令如下： \ndocker rmi 镜像id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802005140488.4384e8ef.png",alt:"image-20220802005140488"}})]),s._v(" "),a("p",[s._v("1、 docker rmi $IMAGE_ID：删除指定镜像")]),s._v(" "),a("p",[s._v("2、 docker rmi "),a("code",[s._v("docker images -q")]),s._v("：删除所有镜像")]),s._v(" "),a("h3",{attrs:{id:"六、容器相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、容器相关命令"}},[s._v("#")]),s._v(" 六、容器相关命令")]),s._v(" "),a("p",[s._v("容器，也是docker中的核心概念，容器是由镜像运行产生的运行实例。镜像和容器的关系，就如同Java语言中类和对象的关系。")]),s._v(" "),a("h4",{attrs:{id:"_1、查看容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、查看容器"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、查看容器")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("查看正在运行的容器使用命令：\ndocker ps\n查看所有容器使用命令：\ndocker ps -a\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802005933035.dca1923f.png",alt:"image-20220802005933035"}})]),s._v(" "),a("h4",{attrs:{id:"_2、创建并启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、创建并启动容器"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2、创建并启动容器")])]),s._v(" "),a("p",[s._v("可以基于已有的镜像来创建和启动容器，创建与启动容器使用命令：docker run")]),s._v(" "),a("p",[a("strong",[s._v("参数说明")]),s._v("：")]),s._v(" "),a("ul",[a("li",[s._v("-i：表示运行容器")]),s._v(" "),a("li",[s._v("-t：表示容器启动后会进入其命令行。加入这两个参数后，容器创建就能登录进去。即分配一个伪终端。")]),s._v(" "),a("li",[s._v("-d：在run后面加上-d参数,则会创建一个守护式容器在后台运行（这样创建容器后不会自动登录容器，如果只加-i -t两个参数，创建后就会自动进去容器）。")]),s._v(" "),a("li",[s._v("--name :为创建的容器命名。")]),s._v(" "),a("li",[s._v("-v：表示目录映射关系（前者是宿主机目录，后者是映射到宿主机上的目录），可以使用多个－v做多个目录或文件映射。注意：最好做目录映射，在宿主机上做修改，然后共享到容器上。")]),s._v(" "),a("li",[s._v("-p：表示端口映射，前者是宿主机端口，后者是容器内的映射端口。可以使用多个-p做多个端口映射")])]),s._v(" "),a("p",[a("strong",[s._v("1")]),s._v("）交互式容器")]),s._v(" "),a("p",[s._v("以"),a("strong",[s._v("交互式")]),s._v("方式创建并启动容器，启动完成后，直接进入当前容器。使用exit命令退出容器。需要注意的是以此种方式启动容器，如果退出容器，则容器会进入"),a("strong",[s._v("停止")]),s._v("状态。")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 先拉取一个镜像；这一步不是每次启动容器都要做的，而是因为前面我们删除了镜像，无镜像可用所以才再拉取一个 \ndocker pull centos:7 \n#创建并启动名称为 mycentos7 的交互式容器；下面指令中的镜像名称 centos:7 也可以使用镜像id \ndocker run -it --name=ydlcentos1 centos:7 /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802010948873.0da1db5b.png",alt:"image-20220802010948873"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802011046622.c8b4b7a2.png",alt:"image-20220802011046622"}})]),s._v(" "),a("p",[a("strong",[s._v("2")]),s._v("）守护式容器")]),s._v(" "),a("p",[s._v("创建一个守护式容器；如果对于一个需要长期运行的容器来说，我们可以创建一个守护式容器。命令如下（容器名称不能重复）：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建并启动守护式容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-di")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ydlcentos2 centos:7 \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#登录进入容器命令为：docker exec -it container_name (或者 container_id) /bin/bash（exit退出 时，容器不会停止） ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" ydlcentos2 /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802011229343.1e39ca1b.png",alt:"image-20220802011229343"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802011349832.2378bfe5.png",alt:"image-20220802011349832"}})]),s._v(" "),a("h4",{attrs:{id:"_3、停止并启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、停止并启动容器"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、停止并启动容器")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 停止正在运行的容器：docker stop 容器名称或者ID \ndocker stop ydlcentos2 \n# 启动已运行过的容器：docker start 容器名称或者ID \ndocker start ydlcentos2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802011603272.13c2326b.png",alt:"image-20220802011603272"}})]),s._v(" "),a("h4",{attrs:{id:"_4、文件拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、文件拷贝"}},[s._v("#")]),s._v(" 4、"),a("strong",[s._v("文件拷贝")])]),s._v(" "),a("p",[s._v("注意：容器在停止状态下也可以完成文件的拷贝")]),s._v(" "),a("p",[s._v("将linux宿主机中的文件拷贝到容器内可以使用命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 需要拷贝的文件或目录 容器名称:容器目录 ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个文件abc.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" itlils.txt \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制abc.txt到mycentos2的容器的 / 目录下 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" itlils.txt ydlcentos2:/root\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入mycentos2容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" ydlcentos2 /bin/bash \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器 / 目录下文件 ")]),s._v("\nll\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802012018175.aef89a53.png",alt:"image-20220802012018175"}})]),s._v(" "),a("p",[s._v("将文件从容器内拷贝出来到linux宿主机使用命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 容器名称:容器目录 需要拷贝的文件或目录")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器后创建文件cba.txt ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" itnanls.log \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在Linux宿主机器执行复制；将容器mycentos2的/cba.txt文件复制到宿主机器的/root目录下 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ydlcentos2:/root/itnanls.log /root\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802012150020.1c4576f5.png",alt:"image-20220802012150020"}})]),s._v(" "),a("h4",{attrs:{id:"_5、目录挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、目录挂载"}},[s._v("#")]),s._v(" "),a("strong",[s._v("5、目录挂载")])]),s._v(" "),a("p",[s._v("可以在创建容器的时候，将宿主机的目录与容器内的目录进行映射，这样我们就可以通过修改宿主机某个目录的文件从而去影响容器。")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802012336743.c39587ed.png",alt:"image-20220802012336743"}})]),s._v(" "),a("p",[s._v("创建容器时添加-v参数，后边为宿主机目录:容器目录，例如： docker run -di -v /root/binlog:/root/binlog --name=ydlcentos3 centos:7")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 创建linux宿主机器要挂载的目录 \nmkdir /root/binlog \n\n# 创建并启动容器ydlcentos3 ,并挂载linux中的/root/binlog 目录到容器的/root/binlog ；也就是在 linux中的/root/binlog 中操作相当于对容器相应目录操作 \ndocker run -di -v /root/binlog:/root/binlog --name=ydlcentos3 centos:7\n\n# 在linux下创建文件 \ntouch /root/binlog/mysql.log \n\n# 进入容器 docker exec -it ydlcentos3 /bin/bash\n\n# 在容器中查看目录中是否有对应文件def.txt \nll /root/binlog\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802012804347.2f9cc43d.png",alt:"image-20220802012804347"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802012812843.ae0981a9.png",alt:"image-20220802012812843"}})]),s._v(" "),a("p",[s._v("注意：如果你共享的是多级的目录，可能会出现权限不足的提示。 这是因为CentOS7中的安全模块selinux把权限禁掉了，需要添加参数 --privileged=true 来解决挂载的目录没有权限的问题。")]),s._v(" "),a("h4",{attrs:{id:"_6、查看容器ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、查看容器ip"}},[s._v("#")]),s._v(" 6、"),a("strong",[s._v("查看容器")]),s._v("ip")]),s._v(" "),a("p",[s._v("可以通过以下命令查看容器运行的各种数据 docker inspect 容器名称（容器ID）")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 在linux宿主机下查看 mycentos3 的ip \ndocker inspect ydlcentos3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("容器之间在一个局域网内，linux宿主机器可以与容器进行通信；但是外部的物理机笔记本是不能与容器直接通信的，如果需要则需要通过宿主机器端口的代理。")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802013027238.fec911e8.png",alt:"image-20220802013027238"}})]),s._v(" "),a("h4",{attrs:{id:"_7、删除容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、删除容器"}},[s._v("#")]),s._v(" "),a("strong",[s._v("7、删除容器")])]),s._v(" "),a("p",[s._v("删除指定的容器：docker rm 容器名称（容器ID） 删除所有容器：docker rm "),a("code",[s._v("docker ps -a -q")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先暂停")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop ydlcentos3\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" ydlcentos3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果容器是运行状态则删除失败，需要停止容器才能删除")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802013334950.24260740.png",alt:"image-20220802013334950"}})]),s._v(" "),a("h2",{attrs:{id:"第二章-部署相关软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二章-部署相关软件"}},[s._v("#")]),s._v(" 第二章 部署相关软件")]),s._v(" "),a("h3",{attrs:{id:"一、mysql容器部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、mysql容器部署"}},[s._v("#")]),s._v(" 一、MySQL容器部署")]),s._v(" "),a("p",[s._v("1.搜索mysql镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802013901040.1c677f13.png",alt:"image-20220802013901040"}})]),s._v(" "),a("p",[s._v("2.拉取mysql镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:5.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("3.创建容器，设置端口映射、目录映射")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在/root目录下创建mysql目录用于存储mysql数据信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/mysql\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3307")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("qjj_mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/mysql/conf:/etc/mysql/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/mysql/logs:/logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -id \\\n-p 3307:3306 \\\n--name=qjj_mysql_3306 \\\n-v /root/mysql_3306/conf:/etc/mysql/conf.d \\\n-v /root/mysql_3306/logs:/logs \\\n-v /root/mysql_3306/data:/var/lib/mysql \\\n-e MYSQL_ROOT_PASSWORD=123456 \\\nmysql:8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("参数说明：\n"),a("ul",[a("li",[a("strong",[s._v("-p 3307:3306")]),s._v("：将容器的 3306 端口映射到宿主机的 3307 端口。")]),s._v(" "),a("li",[a("strong",[s._v("-v $PWD/conf:/etc/mysql/conf.d")]),s._v("：将主机当前目录下的 conf/my.cnf 挂载到容器的 /etc/mysql/my.cnf。配置目录")]),s._v(" "),a("li",[a("strong",[s._v("-v $PWD/logs:/logs")]),s._v("：将主机当前目录下的 logs 目录挂载到容器的 /logs。日志目录")]),s._v(" "),a("li",[a("strong",[s._v("-v $PWD/data:/var/lib/mysql")]),s._v(" ：将主机当前目录下的data目录挂载到容器的 /var/lib/mysql 。数据目录")]),s._v(" "),a("li",[s._v("**-e MYSQL_ROOT_PASSWORD=123456：**初始化 root 用户的密码。")])])])]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802014335044.ef0c1212.png",alt:"image-20220802014335044"}})]),s._v(" "),a("p",[s._v("4.进入容器，操作mysql")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" qjj_mysql /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802014458508.11796e6e.png",alt:"image-20220802014458508"}})]),s._v(" "),a("p",[s._v("5.使用外部机器连接容器中的mysql")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802014616050.536c06a6.png",alt:"image-20220802014616050"}})]),s._v(" "),a("h3",{attrs:{id:"二、tomcat容器部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、tomcat容器部署"}},[s._v("#")]),s._v(" 二、Tomcat容器部署")]),s._v(" "),a("p",[s._v("1.搜索tomcat镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search tomcat\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802014907657.0e4f2da7.png",alt:"image-20220802014907657"}})]),s._v(" "),a("p",[s._v("2.拉取tomcat镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull tomcat\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802014958141.e8fde620.png",alt:"image-20220802014958141"}})]),s._v(" "),a("p",[s._v("3.创建容器，设置端口映射、目录映射")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在/root目录下创建tomcat目录用于存储tomcat数据信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/tomcat\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/tomcat\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ydl_tomcat "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/tomcat:/usr/local/tomcat/webapps "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ntomcat \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("**-p 8080:8080：**将容器的8080端口映射到主机的8080端口")]),s._v(" "),a("p",[s._v("**-v $PWD:/usr/local/tomcat/webapps：**将主机中当前目录挂载到容器的webapps")])])])])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("使用外部机器访问tomcat")]),s._v(" "),a("p",[s._v("http://192.168.246.128:8081/")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802015156699.4d79e120.png",alt:"image-20220802015156699"}})]),s._v(" "),a("p",[a("strong",[s._v("小结")]),s._v("：")]),s._v(" "),a("blockquote",[a("p",[s._v("上传项目文件可以使用容器的目录挂载功能，外部访问可以使用端口映射")])]),s._v(" "),a("h3",{attrs:{id:"三、nginx容器部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、nginx容器部署"}},[s._v("#")]),s._v(" 三、Nginx容器部署")]),s._v(" "),a("p",[s._v("1.搜索nginx镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802015500236.e63a8b02.png",alt:"image-20220802015500236"}})]),s._v(" "),a("p",[s._v("2.拉取nginx镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802015611869.a52d72b8.png",alt:"image-20220802015611869"}})]),s._v(" "),a("p",[s._v("3.创建容器，设置端口映射、目录映射")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在/root目录下创建nginx目录用于存储nginx数据信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/nginx\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" conf\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" conf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在~/nginx/conf/下创建nginx.conf文件,粘贴下面内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" nginx.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("user  nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nworker_processes  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nerror_log  /var/log/nginx/error.log warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\npid        /var/run/nginx.pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\nevents "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    worker_connections  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\nhttp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    include       /etc/nginx/mime.types"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    default_type  application/octet-stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    log_format  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$status $body_bytes_sent \"$http_referer\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    access_log  /var/log/nginx/access.log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    sendfile        on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tcp_nopush     on;")]),s._v("\n\n    keepalive_timeout  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v("\n\n    include /etc/nginx/conf.d/*.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ydl_nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/nginx/logs:/var/log/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /root/nginx/html:/usr/share/nginx/html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nnginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("参数说明：\n"),a("ul",[a("li",[a("strong",[s._v("-p 80:80")]),s._v("：将容器的 80端口映射到宿主机的 80 端口。")]),s._v(" "),a("li",[a("strong",[s._v("-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf")]),s._v("：将主机当前目录下的 /conf/nginx.conf 挂载到容器的 :/etc/nginx/nginx.conf。配置目录")]),s._v(" "),a("li",[a("strong",[s._v("-v $PWD/logs:/var/log/nginx")]),s._v("：将主机当前目录下的 logs 目录挂载到容器的/var/log/nginx。日志目录")])])])]),s._v(" "),a("p",[s._v("4.使用外部机器访问nginx")]),s._v(" "),a("p",[s._v("http://192.168.246.128/")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802015832349.a5c12ff5.png",alt:"image-20220802015832349"}})]),s._v(" "),a("p",[a("strong",[s._v("小结")]),s._v("：")]),s._v(" "),a("blockquote",[a("p",[s._v("如果被占用了80端口，那么在指定映射的时候可以改变宿主机的端口映射，在访问时也需要带上端口号。")])]),s._v(" "),a("h3",{attrs:{id:"四、redis容器部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、redis容器部署"}},[s._v("#")]),s._v(" 四、Redis容器部署")]),s._v(" "),a("p",[s._v("1.搜索redis镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802020222446.3ed0df45.png",alt:"image-20220802020222446"}})]),s._v(" "),a("p",[s._v("2.拉取redis镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis:5.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802020238021.09b0568e.png",alt:"image-20220802020238021"}})]),s._v(" "),a("p",[s._v("3.创建容器，设置端口映射")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /docker/redis\n "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /docker/redis/data\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /docker/redis/conf\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("qjj_redis "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /docker/redis/conf/redis.conf:/etc/redis/conf/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /docker/redis/data:/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" redis redis-server /etc/redis/conf/redis.conf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--appendonly")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("qjj_redis "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 redis\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("4.使用外部机器连接redis")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("./redis-cli.exe "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".246.128 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802020431703.b165c222.png",alt:"image-20220802020431703"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802020540154.6a37b55e.png",alt:"image-20220802020540154"}})]),s._v(" "),a("h3",{attrs:{id:"五、docker-compose简介-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、docker-compose简介-安装"}},[s._v("#")]),s._v(" 五、docker-compose简介&安装")]),s._v(" "),a("h4",{attrs:{id:"_1、-概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-概念"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、")]),s._v(" "),a("strong",[s._v("概念")])]),s._v(" "),a("p",[s._v("Compose项目是Docker官方的开源项目，负责实现对Docker容器集群的快速编排。它"),a("strong",[s._v("是一个定义和运行多容器的")]),s._v("docker应用工具。使用compose，你能通过YMAL文件配置你自己的服务，然后通过一个命令，你能使用配置文件创建和运行所有的服务。")]),s._v(" "),a("h4",{attrs:{id:"_2、-组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、-组成"}},[s._v("#")]),s._v(" "),a("strong",[s._v("2、")]),s._v(" "),a("strong",[s._v("组成")])]),s._v(" "),a("p",[s._v("Docker-Compose将所管理的容器分为三层，分别是工程（project），服务（service）以及容器（container）。Docker-Compose运行目录下的所有文件（docker-compose.yml，extends文件或环境变量文件等）组成一个工程，若无特殊指定工程名即为当前目录名。一个工程当中可包含多个服务，每个服务中定义了容器运行的镜像，参数，依赖。一个服务当中可包括多个容器实例。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("服务（service）")]),s._v("：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。每个服务都有自己的名字、使用的镜像、挂载的数据卷、所属的网络、依赖哪些其他服务等等，即以容器为粒度，用户需要Compose所完成的任务。")]),s._v(" "),a("li",[a("strong",[s._v("项目（project）")]),s._v("：由一组关联的应用容器组成的一个完成业务单元，在docker-compose.yml中定义。即是Compose的一个配置文件可以解析为一个项目，Compose通过分析指定配置文件，得出配置文件所需完成的所有容器管理与部署操作。")])]),s._v(" "),a("p",[s._v("Docker-Compose的工程配置文件默认为docker-compose.yml，可通过环境变量COMPOSE_FILE或-f参数自定义配置文件，其定义了多个有依赖关系的服务及每个服务运行的容器。")]),s._v(" "),a("p",[s._v("使用一个Dockerfifile模板文件，可以让用户很方便的定义一个单独的应用容器。在工作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如：要部署一个Web项目，除了Web服务容器，往往还需要再加上后端的数据库服务容器，甚至还包括负载均衡容器等。")]),s._v(" "),a("h4",{attrs:{id:"_3、安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、安装"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、安装")])]),s._v(" "),a("p",[s._v("Compose目前已经完全支持Linux、Mac OS和Windows，在我们安装Compose之前，需要先安装Docker。下面我们以编译好的二进制包方式安装在Linux系统中。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.24.0/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /usr/local/bin/docker-compose \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置文件可执行权限 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看版本信息 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_4、卸载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、卸载"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4、卸载")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 二进制包方式安装的，删除二进制文件即可 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_5、常用命令参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、常用命令参考"}},[s._v("#")]),s._v(" 5、"),a("strong",[s._v("常用命令参考")])]),s._v(" "),a("p",[s._v("使用Compose前，可以通过执行 docker-compose --help|-h 来查看Compose基本命令用法。")]),s._v(" "),a("p",[s._v("也可以通过执行 docker-compose [COMMAND] --help 或者 docker-compose --help [COMMAND] 来查看某个具体的使用格式。")]),s._v(" "),a("p",[s._v("可以知道Compose命令的基本的使用格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose [-f 参数...] [options] [COMMAND] [ARGS...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("命令选项如下：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-f，–file FILE指定使用的Compose模板文件，默认为docker-compose.yml，可以多次指定。 \n-p，–project-name NAME指定项目名称，默认将使用所在目录名称作为项目名。 \n-x-network-driver 使用Docker的可拔插网络后端特性（需要Docker 1.9 及以后版本） \n-x-network-driver DRIVER指定网络后端的驱动，默认为bridge（需要Docker 1.9 及以后版本） \n-verbose输出更多调试信息 \n-v，-version打印版本并退出\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("Docker Compose")]),s._v("常用命令列表如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("命令")])]),s._v(" "),a("th",[a("strong",[s._v("说明")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("build")]),s._v(" "),a("td",[s._v("构建项目中的服务容器")])]),s._v(" "),a("tr",[a("td",[s._v("help")]),s._v(" "),a("td",[s._v("获得一个命令的帮助")])]),s._v(" "),a("tr",[a("td",[s._v("kill")]),s._v(" "),a("td",[s._v("通过发送SIGKILL信号来强制停止服务容器")])]),s._v(" "),a("tr",[a("td",[s._v("confifig")]),s._v(" "),a("td",[s._v("验证和查看compose文件配置")])]),s._v(" "),a("tr",[a("td",[s._v("create")]),s._v(" "),a("td",[s._v("为服务创建容器。只是单纯的create，还需要使用start启动compose")])]),s._v(" "),a("tr",[a("td",[s._v("down")]),s._v(" "),a("td",[s._v("停止并删除容器，网络，镜像和数据卷")])]),s._v(" "),a("tr",[a("td",[s._v("exec")]),s._v(" "),a("td",[s._v("在运行的容器中执行一个命令")])]),s._v(" "),a("tr",[a("td",[s._v("logs")]),s._v(" "),a("td",[s._v("查看服务容器的输出")])]),s._v(" "),a("tr",[a("td",[s._v("pause")]),s._v(" "),a("td",[s._v("暂停一个服务容器")])]),s._v(" "),a("tr",[a("td",[s._v("port")]),s._v(" "),a("td",[s._v("打印某个容器端口所映射的公共端口")])]),s._v(" "),a("tr",[a("td",[s._v("ps")]),s._v(" "),a("td",[s._v("列出项目中目前的所有容器")])]),s._v(" "),a("tr",[a("td",[s._v("pull")]),s._v(" "),a("td",[s._v("拉取服务依赖的镜像")])]),s._v(" "),a("tr",[a("td",[s._v("push")]),s._v(" "),a("td",[s._v("推送服务镜像")])]),s._v(" "),a("tr",[a("td",[s._v("restart")]),s._v(" "),a("td",[s._v("重启项目中的服务")])]),s._v(" "),a("tr",[a("td",[s._v("rm")]),s._v(" "),a("td",[s._v("删除所有（停止状态的）服务容器")])]),s._v(" "),a("tr",[a("td",[s._v("run")]),s._v(" "),a("td",[s._v("在指定服务上执行一个命令")])]),s._v(" "),a("tr",[a("td",[s._v("scale")]),s._v(" "),a("td",[s._v("设置指定服务运行的容器个数")])]),s._v(" "),a("tr",[a("td",[s._v("start")]),s._v(" "),a("td",[s._v("启动已经存在的服务容器")])]),s._v(" "),a("tr",[a("td",[s._v("stop")]),s._v(" "),a("td",[s._v("停止已经处于运行状态的容器，但不删除它")])]),s._v(" "),a("tr",[a("td",[s._v("top")]),s._v(" "),a("td",[s._v("显示运行的进程")])]),s._v(" "),a("tr",[a("td",[s._v("unpause")]),s._v(" "),a("td",[s._v("恢复处于暂停状态中的服务")])]),s._v(" "),a("tr",[a("td",[s._v("up")]),s._v(" "),a("td",[s._v("自动完成包括构建镜像、创建服务、启动服务并关闭关联服务相关容器的一些列操作")])]),s._v(" "),a("tr",[a("td",[s._v("version")]),s._v(" "),a("td",[s._v("打印版本信息")])])])]),s._v(" "),a("p",[s._v("1.up")]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose up [options] [--scale SERVICE=NUM...] [SERVICE...] \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("up命令十分强大，它尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一些列操作。链接的服务都将会被自动启动，除非已经处于运行状态。")]),s._v(" "),a("p",[s._v("多数情况下我们可以直接通过该命令来启动一个项目。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-d 在后台运行服务容器 \n–no-color 不使用颜色来区分不同的服务的控制输出 \n–no-deps 不启动服务所链接的容器 \n–force-recreate 强制重新创建容器，不能与–no-recreate同时使用 \n–no-recreate 如果容器已经存在，则不重新创建，不能与–force-recreate同时使用 \n–no-build 不自动构建缺失的服务镜像 \n–build 在启动容器前构建服务镜像 \n–abort-on-container-exit 停止所有容器，如果任何一个容器被停止，不能与-d同时使用 \n-t, --timeout TIMEOUT 停止容器时候的超时（默认为10秒） \n–remove-orphans 删除服务中没有在compose文件中定义的容器 \n–scale SERVICE=NUM 设置服务运行容器的个数，将覆盖在compose中通过scale指定的参数\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[a("strong",[s._v("2. ps")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose ps [options] [SERVICE...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("列出项目中目前的所有容器。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-q 只打印容器的ID信息\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("3. stop")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose stop [options] [SERVICE...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("停止已经处于运行状态的容器，但不删除它。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-t, --timeout TIMEOUT 停止容器时候的超时（默认为10秒）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("4. down")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose down [options]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("停止和删除容器、网络、卷、镜像，这些内容是通过docker-compose up命令创建的. 默认值删除 容器 网络，可以通过指定 rmi 、volumes参数删除镜像和卷。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("–rmi type 删除镜像，类型必须是: ‘all’: 删除compose文件中定义的所以镜像；‘local’: 删除镜像名为空的 镜像\n-v, --volumes 删除已经在compose文件中定义的和匿名的附在容器上的数据卷 \n–remove-orphans 删除服务中没有在compose中定义的容器\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("5. restart")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose restart [options] [SERVICE...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("重启项目中的服务。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-t, --timeout TIMEOUT 指定重启前停止容器的超时（默认为10秒）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("6. rm")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose rm [options] [SERVICE...] 1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("删除所有（停止状态的）服务容器。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("–f, --force 强制直接删除，包括非停止状态的容器 \n-v 删除容器所挂载的数据卷\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("7. start")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose start [SERVICE...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("启动已经存在的服务容器。")]),s._v(" "),a("p",[a("strong",[s._v("8. run")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose run [options] [-v VOLUME...] [-p PORT...] [-e KEY=VAL...] SERVICE [COMMAND] [ARGS...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在指定服务上执行一个命令。")]),s._v(" "),a("p",[s._v("例如：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose run ubuntu ping www.baidu.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将会执行一个ubuntu容器，并执行ping www.baidu.com命令。")]),s._v(" "),a("p",[s._v("默认情况下，如果存在关联，则所有关联的服务将会自动被启动，除非这些服务已经在运行中。该命令类似于启动容")]),s._v(" "),a("p",[s._v("器后运行指定的命令，相关卷、链接等都会按照配置自动创建。有两个不同点：")]),s._v(" "),a("ol",[a("li",[s._v("给定命令将会覆盖原有的自动运行命令")]),s._v(" "),a("li",[s._v("不会自动创建端口，以避免冲突")])]),s._v(" "),a("p",[s._v("如果不希望自动启动关联的容器，可以使用–no-deps选项，例如：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose run --no-deps web\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将不会启动web容器关联的其他容器")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('-d 在后台运行服务容器 \n–name NAME 为容器指定一个名字 \n–entrypoint CMD 覆盖默认的容器启动指令 \n-e KEY=VAL 设置环境变量值，可多次使用选项来设置多个环境变量\n-u, --user="" 指定运行容器的用户名或者uid\n–no-deps 不自动启动管理的服务容器 \n–rm 运行命令后自动删除容器，d模式下将忽略 \n-p, --publish=[] 映射容器端口到本地主机 \n–service-ports 配置服务端口并映射到本地主机 \n-v, --volume=[] 绑定一个数据卷，默认为空 \n-T 不分配伪tty，意味着依赖tty的指令将无法运行 \n-w, --workdir="" 为容器指定默认工作目录\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[a("strong",[s._v("9. confifig")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose config [options]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("验证并查看compose文件配置。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("–resolve-image-digests 将镜像标签标记为摘要 \n-q, --quiet 只验证配置，不输出。 当配置正确时，不输出任何内容，当文件配置错误，输出错误信息 \n–services 打印服务名，一行一个 \n–volumes 打印数据卷名，一行一个\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("10. kill")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose kill [options] [SERVICE...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("通过发送SIGKILL信号来强制停止服务容器。 支持通过-s参数来指定发送的信号，例如：通过如下指令发送SIGINT信号：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose kill -s SIGINT\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("11. create")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose create [options] [SERVICE...] 1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("为服务创建容器.只是单纯的create，还需要使用start启动compose。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("–force-recreate 重新创建容器，即使它的配置和镜像没有改变，不兼容–no-recreate参数 \n–no-recreate 如果容器已经存在，不需要重新创建. 不兼容–force-recreate参数 \n–no-build 不创建镜像，即使缺失 \n–build 创建容器前，生成镜像\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("12. exec")])]),s._v(" "),a("p",[s._v("格式为：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker-compose exec [options] SERVICE COMMAND [ARGS...]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("与 docker exec 命令功能相同，可以通过service name登陆到容器中。")]),s._v(" "),a("p",[s._v("选项包括：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-d 分离模式，后台运行命令. \n–privileged 获取特权. \n–user USER 指定运行的用户. \n-T 禁用分配TTY. By default docker-compose exec分配 a TTY. \n–index=index 当一个服务拥有多个容器时，可通过该参数登陆到该服务下的任何服务，例如：docker-compose exec --index=1 web /bin/bash ，web服务中包含多个容器\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"六、compose模版文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、compose模版文件"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E5%85%AD%E3%80%81compose%E6%A8%A1%E7%89%88%E6%96%87%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("六、Compose模版文件")]),s._v(" "),a("p",[s._v("模板文件是使用Compose的核心，涉及的指令关键字也比较多，大部分指令与 docker run 相关参数的含义都是类似的。默认的模板文件名称为docker-compose.yml，格式为YAML格式。")]),s._v(" "),a("p",[s._v("比如一个Compose模板文件：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('version: "2" \n\tservices: \n\t\tweb:\n\t\t\timages: nginx \n\t\t\tports: -"8080:80" \n\t\t\tvolumes: - /usr/local/abc:/usr/local/cba \n#volumes: \n#networks:\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("Docker Compose的模板文件主要分为3个区域，如下：")]),s._v(" "),a("ul",[a("li",[s._v("services\n"),a("ul",[a("li",[s._v("服务，在它下面可以定义应用需要的一些服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷、所属的网络、依赖哪些其他服务等等。")])])]),s._v(" "),a("li",[s._v("volumes\n"),a("ul",[a("li",[s._v("数据卷，在它下面可以定义的数据卷（名字等等），然后挂载到不同的服务下去使用。")])])]),s._v(" "),a("li",[s._v("networks\n"),a("ul",[a("li",[s._v("应用的网络，在它下面可以定义应用的名字、使用的网络类型等等。")])])])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("指令")])]),s._v(" "),a("th",[a("strong",[s._v("功能")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("build")]),s._v(" "),a("td",[s._v("指定服务镜像Dockerfifile所在路径")])]),s._v(" "),a("tr",[a("td",[s._v("cap_dd，cap_drop")]),s._v(" "),a("td",[s._v("指定容器的内核能力（capacity）分配")])]),s._v(" "),a("tr",[a("td",[s._v("command")]),s._v(" "),a("td",[s._v("覆盖容器启动后默认执行的命令")])]),s._v(" "),a("tr",[a("td",[s._v("cgroup_parent")]),s._v(" "),a("td",[s._v("指定父cgroup组，意味着将基础该组的资源限制")])]),s._v(" "),a("tr",[a("td",[s._v("container_name")]),s._v(" "),a("td",[s._v("指定容器名称。默认将会使用项目名称服务名称序号这样的格式")])]),s._v(" "),a("tr",[a("td",[s._v("devices")]),s._v(" "),a("td",[s._v("指定设置映射关系")])]),s._v(" "),a("tr",[a("td",[s._v("dns")]),s._v(" "),a("td",[s._v("自定义DNS服务器。可以是一个值，也可以是一个列表")])]),s._v(" "),a("tr",[a("td",[s._v("dns_search")]),s._v(" "),a("td",[s._v("配置DNS搜索域。可以是一个值，也可以是一个列表")])]),s._v(" "),a("tr",[a("td",[s._v("dockerfifile")]),s._v(" "),a("td",[s._v("指定额外编译镜像的Dockerfifile文件，可以通过该指令来指定")])]),s._v(" "),a("tr",[a("td",[s._v("env_fifile")]),s._v(" "),a("td",[s._v("从文件中获取环境变量，可以为单独的文件路径或列表")])]),s._v(" "),a("tr",[a("td",[s._v("environment")]),s._v(" "),a("td",[s._v("设置环境变量，可以使用数组或字典两种格式")])]),s._v(" "),a("tr",[a("td",[s._v("expose")]),s._v(" "),a("td",[s._v("暴露端口")])]),s._v(" "),a("tr",[a("td",[s._v("external_links")]),s._v(" "),a("td",[s._v("链接到docker-compose.yml外部的容器，甚至可以是非Compose管理的外部容器")])]),s._v(" "),a("tr",[a("td",[s._v("extra_hosts")]),s._v(" "),a("td",[s._v("指定额外的host名称映射信息")])]),s._v(" "),a("tr",[a("td",[s._v("image")]),s._v(" "),a("td",[s._v("指定为镜像名称或镜像ID。如果镜像在本地不存在，Compose将会尝试拉取这个镜像")])]),s._v(" "),a("tr",[a("td",[s._v("labels")]),s._v(" "),a("td",[s._v("指定服务镜像Dockerfifile所在路径")])]),s._v(" "),a("tr",[a("td",[s._v("links")]),s._v(" "),a("td",[s._v("链接到其他服务中的容器")])]),s._v(" "),a("tr",[a("td",[s._v("log_driver")]),s._v(" "),a("td",[s._v("指定日志驱动类型，类似于Docker中的–log-driver参数。目前支持三种日志驱动类型：log_driver:“json-fifile”、log_driver:“syslog”、log_driver:“none”")])]),s._v(" "),a("tr",[a("td",[s._v("log_opt")]),s._v(" "),a("td",[s._v("日志驱动的相关参数")])]),s._v(" "),a("tr",[a("td",[s._v("net")]),s._v(" "),a("td",[s._v("设置网络模式。参数类似于docker clinet的–net参数一样")])]),s._v(" "),a("tr",[a("td",[s._v("pid")]),s._v(" "),a("td",[s._v("跟主机系统共享进程命名空间。打开该选项的容器之间，以及容器和宿主机系统之间可以通过进程ID来相互访问和操作")])]),s._v(" "),a("tr",[a("td",[s._v("ports")]),s._v(" "),a("td",[s._v("暴露端口信息")])]),s._v(" "),a("tr",[a("td",[s._v("security_opt")]),s._v(" "),a("td",[s._v("指定容器模板标签（label）机制的默认属性（如用户、角色、类型、级别等）")])]),s._v(" "),a("tr",[a("td",[s._v("ulimits")]),s._v(" "),a("td",[s._v("指定容器的ulimits限制值")])]),s._v(" "),a("tr",[a("td",[s._v("volumes")]),s._v(" "),a("td",[s._v("数据卷所挂载路径设置。可以设置宿主机路径（HOST:CONTAINER）或加上访问模式(HOST:CONTAINER:ro）")])])])]),s._v(" "),a("h3",{attrs:{id:"七、compose应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、compose应用"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E4%B8%83%E3%80%81compose%E5%BA%94%E7%94%A8",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("七、Compose应用")]),s._v(" "),a("p",[a("strong",[s._v("需求")]),s._v("：编写compose模版文件，实现同时启动tomcat、mysql和redis容器。")]),s._v(" "),a("h4",{attrs:{id:"_1、-编写模版文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-编写模版文件"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_1%E3%80%81-%E7%BC%96%E5%86%99%E6%A8%A1%E7%89%88%E6%96%87%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("1、")]),s._v(" "),a("strong",[s._v("编写模版文件")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/local/mycompose \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入文件夹 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mycompose \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建 docker-compose.yml文件；内容如下 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" docker-compose.yml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("docker-compose.yml文件内容如下（文件内容请从 资料\\配置文件\\docker-compose.yml 复制）：")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('version: \'3\'\nservices:\n  redis1:\n    image: redis\n    ports:\n      - "6379:6379"\n    container_name: "redis1"\n    networks: \n      - dev\n  mysql1:\n    image: centos/mysql-57-centos7\n    environment:\n      MYSQL_ROOT_PASSWORD: "root"\n    ports: \n      - "3306:3306"\n    container_name: "mysql1"\n    networks: \n      - dev\n  web1:\n    image: tomcat\n    ports: \n      - "9090:8080"\n    container_name: "web1"\n    networks: \n      - dev\n      - pro\nnetworks:\n  dev:\n    driver: bridge\n  pro:\n    driver: bridge\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[s._v("上面我们声明了3个服务；分别是：redis1、mysql1、web1；并且对3个服务都指定了对应的docker 镜像和端口。")]),s._v(" "),a("h4",{attrs:{id:"_2、启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、启动"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_2%E3%80%81%E5%90%AF%E5%8A%A8",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("2")]),s._v("、"),a("strong",[s._v("启动")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#启动前最好把docker重启，不然原来的tomcat/mysql/redis容器也是启动状态的话，那么端口会冲突而启动失败 \nsystemctl restart docker \n\ncd /usr/local/mycompose \n\ndocker-compose up \n\n# 如果后台启动则使用如下命令 \ndocker-compose up -d \n\n# 若要停止 \ndocker-compose stop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("可以查看到命令中，创建了两个自定义的网络（mycompose_dev和mycompose_pro），然后创建容器，并「Attaching to …」，将网络应用到服务上。")]),s._v(" "),a("p",[s._v("可以查看一下具体的网络，使用docker network ls 如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802030057950.73932fc5.png",alt:"image-20220802030057950"}})]),s._v(" "),a("p",[s._v("查看启动的容器：")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802030034771.cd359b2e.png",alt:"image-20220802030034771"}})]),s._v(" "),a("h4",{attrs:{id:"_3、-测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、-测试"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_3%E3%80%81-%E6%B5%8B%E8%AF%95",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("3、")]),s._v(" "),a("strong",[s._v("测试")])]),s._v(" "),a("p",[s._v("在windows下访问启动的3个服务进行测试都可以；如下面访问9090的tomcat如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802030132427.e2867ecf.png",alt:"image-20220802030132427"}})]),s._v(" "),a("h2",{attrs:{id:"第三章-迁移备份仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三章-迁移备份仓库"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E8%BF%81%E7%A7%BB%E5%A4%87%E4%BB%BD%E4%BB%93%E5%BA%93",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("第三章 迁移备份仓库")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802035604213.a1ff4638.png",alt:"image-20220802035604213"}})]),s._v(" "),a("h3",{attrs:{id:"一、迁移与备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、迁移与备份"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E4%B8%80%E3%80%81%E8%BF%81%E7%A7%BB%E4%B8%8E%E5%A4%87%E4%BB%BD",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("一、迁移与备份")]),s._v(" "),a("h4",{attrs:{id:"_1、-将docker容器保存为镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-将docker容器保存为镜像"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_1%E3%80%81-%E5%B0%86docker%E5%AE%B9%E5%99%A8%E4%BF%9D%E5%AD%98%E4%B8%BA%E9%95%9C%E5%83%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("1、")]),s._v(" "),a("strong",[s._v("将")]),s._v("Docker容器保存为镜像")]),s._v(" "),a("p",[s._v("使用docker commit命令可以将容器保存为镜像。")]),s._v(" "),a("p",[s._v("命令形式：docker commit 容器名称 镜像名称")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存nginx容器为镜像 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit ydlcentos1 ydlcentos1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("此镜像的内容就是当前容器的内容，接下来你可以用此镜像再次运行新的容器")]),s._v(" "),a("h4",{attrs:{id:"_2、-镜像备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、-镜像备份"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_2%E3%80%81-%E9%95%9C%E5%83%8F%E5%A4%87%E4%BB%BD",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("2、")]),s._v(" "),a("strong",[s._v("镜像备份")])]),s._v(" "),a("p",[s._v("使用docker save命令可以将已有镜像保存为tar 文件。")]),s._v(" "),a("p",[s._v("命令形式：docker save –o tar文件名 镜像名")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 保存镜像为文件 \ndocker save -o ydlcentos1.tar ydlcentos1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802032156887.a2e3f565.png",alt:"image-20220802032156887"}})]),s._v(" "),a("h4",{attrs:{id:"_3、-镜像恢复与迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、-镜像恢复与迁移"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_3%E3%80%81-%E9%95%9C%E5%83%8F%E6%81%A2%E5%A4%8D%E4%B8%8E%E8%BF%81%E7%A7%BB",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("3、")]),s._v(" "),a("strong",[s._v("镜像恢复与迁移")])]),s._v(" "),a("p",[s._v("使用docker load命令可以根据tar文件恢复为docker镜像。")]),s._v(" "),a("p",[s._v("命令形式：docker load -i tar文件名")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 停止mynginx容器 \ndocker stop ydlcentos1 \n# 删除mynginx容器 \ndocker rm ydlcentos1 \n# 删除mynginx镜像 \ndocker rmi ydlcentos1 \n# 加载恢复mynginx镜像 \ndocker load -i ydlcentos1.tar \n# 在镜像恢复之后，基于该镜像再次创建启动容器 \ndocker run -di --name=ydlcentos1 ydlcentos1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("注意：在执行docker load命令恢复镜像时，需要先删除原镜像。")]),s._v(" "),a("h3",{attrs:{id:"二、-使用dockerfile创建镜像-根据我们的流程-制作镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、-使用dockerfile创建镜像-根据我们的流程-制作镜像"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E4%BA%8C%E3%80%81-%E4%BD%BF%E7%94%A8dockerfile%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("二、 使用Dockerfile创建镜像（根据我们的流程 制作镜像）")]),s._v(" "),a("h4",{attrs:{id:"_1、-什么是dockerfile文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-什么是dockerfile文件"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_1%E3%80%81-%E4%BB%80%E4%B9%88%E6%98%AFdockerfile%E6%96%87%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("1、")]),s._v(" "),a("strong",[s._v("什么是")]),s._v("Dockerfile文件")]),s._v(" "),a("p",[s._v("前面的课程中已经知道了，要获得镜像，可以从Docker仓库中进行下载。那如果我们想自己开发一个镜像，那该如何做呢？答案是：Dockerfifile")]),s._v(" "),a("p",[s._v("Dockerfifile其实就是一个文本文件，由一系列命令和参数构成，Docker可以读取Dockerfifile文件并根据Dockerfifile文件的描述来构建镜像。")]),s._v(" "),a("p",[s._v("Dockerfifile文件内容一般分为4部分：")]),s._v(" "),a("ul",[a("li",[s._v("基础镜像信息")]),s._v(" "),a("li",[s._v("维护者信息")]),s._v(" "),a("li",[s._v("镜像操作指令")]),s._v(" "),a("li",[s._v("容器启动时执行的指令")])]),s._v(" "),a("h4",{attrs:{id:"_2、dockerfifile常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、dockerfifile常用命令"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_2%E3%80%81dockerfifile%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("2、Dockerfifile常用命令")]),s._v(" "),a("p",[s._v("Dockerfile可以基于镜像制作镜像；"),a("code",[s._v("docker build -t='jdk1.8' .")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("关键字")]),s._v(" "),a("th",[s._v("作用")]),s._v(" "),a("th",[s._v("备注")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("FROM")]),s._v(" "),a("td",[s._v("指定父镜像")]),s._v(" "),a("td",[s._v("指定dockerfile基于那个image构建")])]),s._v(" "),a("tr",[a("td",[s._v("MAINTAINER")]),s._v(" "),a("td",[s._v("作者信息")]),s._v(" "),a("td",[s._v("用来标明这个dockerfile谁写的")])]),s._v(" "),a("tr",[a("td",[s._v("LABEL")]),s._v(" "),a("td",[s._v("标签")]),s._v(" "),a("td",[s._v("用来标明dockerfile的标签 可以使用Label代替Maintainer 最终都是在docker image基本信息中可以查看")])]),s._v(" "),a("tr",[a("td",[s._v("RUN")]),s._v(" "),a("td",[s._v("执行命令")]),s._v(" "),a("td",[s._v('执行一段命令 默认是/bin/sh 格式: RUN command 或者 RUN ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("CMD")]),s._v(" "),a("td",[s._v("容器启动命令")]),s._v(" "),a("td",[s._v('提供启动容器时候的默认命令 和ENTRYPOINT配合使用.格式 CMD command param1 param2 或者 CMD ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("ENTRYPOINT")]),s._v(" "),a("td",[s._v("入口")]),s._v(" "),a("td",[s._v("一般在制作一些执行就关闭的容器中会使用")])]),s._v(" "),a("tr",[a("td",[s._v("COPY")]),s._v(" "),a("td",[s._v("复制文件")]),s._v(" "),a("td",[s._v("build的时候复制文件到image中")])]),s._v(" "),a("tr",[a("td",[s._v("ADD")]),s._v(" "),a("td",[s._v("添加文件")]),s._v(" "),a("td",[s._v("build的时候添加文件到image中 不仅仅局限于当前build上下文 可以来源于远程服务")])]),s._v(" "),a("tr",[a("td",[s._v("ENV")]),s._v(" "),a("td",[s._v("环境变量")]),s._v(" "),a("td",[s._v("指定build时候的环境变量 可以在启动的容器的时候 通过-e覆盖 格式ENV name=value")])]),s._v(" "),a("tr",[a("td",[s._v("ARG")]),s._v(" "),a("td",[s._v("构建参数")]),s._v(" "),a("td",[s._v("构建参数 只在构建的时候使用的参数 如果有ENV 那么ENV的相同名字的值始终覆盖arg的参数")])]),s._v(" "),a("tr",[a("td",[s._v("VOLUME")]),s._v(" "),a("td",[s._v("定义外部可以挂载的数据卷")]),s._v(" "),a("td",[s._v('指定build的image那些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 -v 绑定 格式 VOLUME ["目录"]')])]),s._v(" "),a("tr",[a("td",[s._v("EXPOSE")]),s._v(" "),a("td",[s._v("暴露端口")]),s._v(" "),a("td",[s._v("定义容器运行的时候监听的端口 启动容器的使用-p来绑定暴露端口 格式: EXPOSE 8080 或者 EXPOSE 8080/udp")])]),s._v(" "),a("tr",[a("td",[s._v("WORKDIR")]),s._v(" "),a("td",[s._v("工作目录")]),s._v(" "),a("td",[s._v("指定容器内部的工作目录 如果没有创建则自动创建 如果指定/ 使用的是绝对地址 如果不是/开头那么是在上一条workdir的路径的相对路径")])]),s._v(" "),a("tr",[a("td",[s._v("USER")]),s._v(" "),a("td",[s._v("指定执行用户")]),s._v(" "),a("td",[s._v("指定build或者启动的时候 用户 在RUN CMD ENTRYPONT执行的时候的用户")])]),s._v(" "),a("tr",[a("td",[s._v("HEALTHCHECK")]),s._v(" "),a("td",[s._v("健康检查")]),s._v(" "),a("td",[s._v("指定监测当前容器的健康监测的命令 基本上没用 因为很多时候 应用本身有健康监测机制")])]),s._v(" "),a("tr",[a("td",[s._v("ONBUILD")]),s._v(" "),a("td",[s._v("触发器")]),s._v(" "),a("td",[s._v("当存在ONBUILD关键字的镜像作为基础镜像的时候 当执行FROM完成之后 会执行 ONBUILD的命令 但是不影响当前镜像 用处也不怎么大")])]),s._v(" "),a("tr",[a("td",[s._v("STOPSIGNAL")]),s._v(" "),a("td",[s._v("发送信号量到宿主机")]),s._v(" "),a("td",[s._v("该STOPSIGNAL指令设置将发送到容器的系统调用信号以退出。")])]),s._v(" "),a("tr",[a("td",[s._v("SHELL")]),s._v(" "),a("td",[s._v("指定执行脚本的shell")]),s._v(" "),a("td",[s._v("指定RUN CMD ENTRYPOINT 执行命令的时候 使用的shell")])])])]),s._v(" "),a("h4",{attrs:{id:"_3、-使用dockerfile创建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、-使用dockerfile创建镜像"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_3%E3%80%81-%E4%BD%BF%E7%94%A8dockerfile%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("3、")]),s._v(" "),a("strong",[s._v("使用Dockerfile创建镜像")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、创建目录 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" –p /usr/local/dockerjdk8 \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/dockerjdk8 \n\n\nrz "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-be")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、下载jdk-8u231-linux-x64.tar.gz并上传到服务器（虚拟机）中的/usr/local/dockerjdk8目录 ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、在/usr/local/dockerjdk8目录下创建Dockerfile文件，文件内容如下： ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile \n\nFROM centos:7 \nMAINTAINER ITLILS \nWORKDIR /usr \nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/java \nADD jdk-8u231-linux-x64.tar.gz /usr/local/java/ \nENV JAVA_HOME /usr/local/java/jdk1.8.0_231 \nENV JRE_HOME "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre \nENV CLASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v(" \nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、执行命令构建镜像；不要忘了后面的那个 . ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jdk1.8'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、查看镜像是否建立完成 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n\n\n\n\n\n\nFROM ubuntu\nMAINTAINER QJJTest\nWORKDIR /usr \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#java")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/java \nADD jdk-8u333-linux-x64.tar.gz /usr/local/java/ \nENV JAVA_HOME /usr/local/java/jdk1.8.0_333 \nENV JRE_HOME "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre \nENV CLASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v(" \nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入项目")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/bin/project\nADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" /usr/bin/project/app.jar\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n\n\n\n\n\nFROM jdk1.8\nMAINTAINER QJJTest\nWORKDIR /usr \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入项目")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/bin/project\nADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v("\nEXNTRYPOINT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(" ,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("-jar"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ,"')]),s._v('"/usr/bin/project/app.jar"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8089")]),s._v(":8888 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("java_project_net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" mycompose_dev "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\njava_project\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":8888 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project_test2_net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" mycompose_dev "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nproject_test2\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802034204602.52a6d1f9.png",alt:"image-20220802034204602"}})]),s._v(" "),a("h4",{attrs:{id:"_4、-基于镜像创建容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、-基于镜像创建容器"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_4%E3%80%81-%E5%9F%BA%E4%BA%8E%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("4、")]),s._v(" "),a("strong",[s._v("基于镜像创建容器")])]),s._v(" "),a("p",[s._v("基于刚刚创建的镜像 jdk1.8 创建并启动容器进行测试；")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建并启动容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("testjdk jdk1.8 /bin/bash \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容器中测试jdk是否已经安装 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802034313026.97b93b5b.png",alt:"image-20220802034313026"}})]),s._v(" "),a("p",[a("strong",[s._v("作业：")])]),s._v(" "),a("ol",[a("li",[s._v("boot 一个controller 访问/test,返回“hello yuandongli!”")]),s._v(" "),a("li",[s._v("打成jar包，使用Dockerfile，centos:7为底构建一个镜像，起起来，可以访问到8080/test,返回“hello yuandongli!”")])]),s._v(" "),a("h3",{attrs:{id:"三、-私有仓库搭建与配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、-私有仓库搭建与配置"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#%E4%B8%89%E3%80%81-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("三、 私有仓库搭建与配置")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802035500638.f74f89e7.png",alt:"image-20220802035500638"}})]),s._v(" "),a("h4",{attrs:{id:"_1-私有仓库搭建与配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-私有仓库搭建与配置"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_1-%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("1.")]),s._v(" "),a("strong",[s._v("私有仓库搭建与配置")])]),s._v(" "),a("p",[s._v("Docker官方的Docker hub（https://hub.docker.com）是一个用于管理公共镜像的仓库，我们可以从上面拉取镜像到本地，也可以把我们自己的镜像推送上去。但是，有时候我们的服务器无法访问互联网，或者你不希望将自己的镜像放到公网当中，那么我们就需要搭建自己的私有仓库来存储和管理自己的镜像。")]),s._v(" "),a("p",[s._v("私有仓库搭建步骤：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、拉取私有仓库镜像 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull registry\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、启动私有仓库容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("registry "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(":5000 registry\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 3、打开浏览器 输入地址http://私有仓库服务器ip:5000/v2/_catalog，看到{"repositories":[]} 表示私有仓库 搭建成功')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、修改daemon.json   ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json   \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在上述文件中添加一个key，保存退出。此步用于让 docker 信任私有仓库地址；注意将私有仓库服务器ip修改为自己私有仓库服务器真实ip ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://mirror.ccs.tencentyun.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"insecure-registries"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"124.220.78.31:5000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、重启docker 服务 ")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start registry\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802035716690.5eaa68fb.png",alt:"image-20220802035716690"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802035845322.f9eec603.png",alt:"image-20220802035845322"}})]),s._v(" "),a("h4",{attrs:{id:"_2-将镜像上传至私有仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-将镜像上传至私有仓库"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_2-%E5%B0%86%E9%95%9C%E5%83%8F%E4%B8%8A%E4%BC%A0%E8%87%B3%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("2.")]),s._v(" "),a("strong",[s._v("将镜像上传至私有仓库")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、标记镜像为私有仓库的镜像     ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag java_project "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.220")]),s._v(".78.31:5000/java_project_registery\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、上传标记的镜像     ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.220")]),s._v(".78.31:5000/java_project_registery\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802040142936.cd6ccb18.png",alt:"image-20220802040142936"}})]),s._v(" "),a("h4",{attrs:{id:"_3-从私有仓库拉取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-从私有仓库拉取镜像"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.ydlclass.com/doc21xnv/docker/#_3-%E4%BB%8E%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),a("strong",[s._v("3.")]),s._v(" "),a("strong",[s._v("从私有仓库拉取镜像")])]),s._v(" "),a("p",[a("strong",[s._v("（1）")]),s._v(" "),a("strong",[s._v("私有仓库所在服务器拉取镜像")])]),s._v(" "),a("p",[s._v("若是在私有仓库所在的服务器上去拉取镜像；那么直接执行如下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为私有仓库所在的服务器上已经存在相关镜像；所以先删除；请指定镜像名，不是id ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".246.128:5000/redis:5.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拉取镜像 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".246.128:5000/redis:5.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可以通过如下命令查看 docker 的信息；了解到私有仓库地址 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802040432037.627459e6.png",alt:"image-20220802040432037"}})]),s._v(" "),a("p",[s._v("在仓库所在服务器上去拉取镜像是比较少有的操作；作为了解即可。")]),s._v(" "),a("p",[a("strong",[s._v("（2）")]),s._v(" "),a("strong",[s._v("其它服务器拉取私有仓库镜像")])]),s._v(" "),a("p",[s._v("大多数情况下，都是某台服务器部署了私有镜像仓库之后；到其它服务器上从私有仓库中拉取镜像，若要拉取私有仓库镜像需要去修改docker的配置文件，设置启动时候的仓库地址。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开配置文件 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /usr/lib/systemd/system/docker.service \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在打开的上述文件中按照下面的图，添加如下的内容；注意修改下面内容中的ip地址 ")]),s._v("\n--add-registry"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.220")]),s._v(".78.31:5000 --insecure-registry"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.220")]),s._v(".78.31:5000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改完后需要重新加载docker配置文件并重启docker ")]),s._v("\nsystemctl daemon-reload \nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("在重启之后；那么则可以去拉取私有仓库中的镜像：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行拉取镜像命令并查看 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.220")]),s._v(".78.31:5000/java_project_registery\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"四、和虚拟机对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、和虚拟机对比"}},[s._v("#")]),s._v(" 四、和虚拟机对比")]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20200622200917932.0185b1c3.png",alt:"image-20200622200917932"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20200622200927992.2fb8689d.png",alt:"image-20200622200927992"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"Docker.assets/image-20220802041415505.8a5a6240.png",alt:"image-20220802041415505"}})]),s._v(" "),a("h1",{attrs:{id:"命令总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令总结"}},[s._v("#")]),s._v(" 命令总结")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step 1: 安装必要的一些系统工具")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" apt-transport-https ca-certificates "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" software-properties-common\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step 2: 安装GPG证书")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 3: 写入软件源信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" add-apt-repository "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-cs")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(' stable"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 4: 更新并安装 Docker-CE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、 安装docker；出现输入的界面都按 y ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" docker-ce\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、 查看docker版本 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("1、 编辑文件/etc/docker/daemon.json")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行如下命令： ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/docker \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("daemon.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("2、在文件中加入下面内容")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.mirrors.ustc.edu.cn"')]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo"')]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://mirror.ccs.tencentyun.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("Docker启动与停止命令")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动docker服务： ")]),s._v("\nsystemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止docker服务： ")]),s._v("\nsystemctl stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启docker服务： ")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docker服务状态： ")]),s._v("\nsystemctl status "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动docker服务： ")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建并启动守护式容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-di")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ydlcentos2 centos:7 \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#登录进入容器命令为：docker exec -it container_name (或者 container_id) /bin/bash（exit退出 时，容器不会停止） ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" ydlcentos2 /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),a("h3",{attrs:{id:"docker-compose简介-安装-用来创建容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose简介-安装-用来创建容器"}},[s._v("#")]),s._v(" docker-compose简介&安装 \t\t(用来创建容器)")]),s._v(" "),a("h4",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" "),a("strong",[s._v("概念")])]),s._v(" "),a("p",[s._v("Compose项目是Docker官方的开源项目，负责实现对Docker容器集群的快速编排。它"),a("strong",[s._v("是一个定义和运行多容器的")]),s._v("docker应用工具。使用compose，你能通过YMAL文件配置你自己的服务，然后通过一个命令，你能使用配置文件创建和运行所有的服务。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.24.0/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /usr/local/bin/docker-compose \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置文件可执行权限 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看版本信息 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"compose应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose应用"}},[s._v("#")]),s._v(" Compose应用")]),s._v(" "),a("p",[a("strong",[s._v("需求")]),s._v("：编写compose模版文件，实现同时启动tomcat、mysql和redis容器。")]),s._v(" "),a("h4",{attrs:{id:"编写模版文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写模版文件"}},[s._v("#")]),s._v(" "),a("strong",[s._v("编写模版文件")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /usr/local/mycompose \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入文件夹 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mycompose \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建 docker-compose.yml文件；内容如下 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" docker-compose.yml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("docker-compose.yml文件内容如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("version: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\nservices:\n  redis1:\n    image: redis\n    ports:\n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379:6379"')]),s._v("\n    container_name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis1"')]),s._v("\n    networks: \n      - dev\n  mysql1:\n    image: centos/mysql-57-centos7\n    environment:\n      MYSQL_ROOT_PASSWORD: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n    ports: \n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3306:3306"')]),s._v("\n    container_name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql1"')]),s._v("\n    networks: \n      - dev\n  web1:\n    image: tomcat\n    ports: \n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9090:8080"')]),s._v("\n    container_name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"web1"')]),s._v("\n    networks: \n      - dev\n      - pro\nnetworks:\n  dev:\n    driver: bridge\n  pro:\n    driver: bridge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[s._v("上面我们声明了3个服务；分别是：redis1、mysql1、web1；并且对3个服务都指定了对应的docker 镜像和端口。")]),s._v(" "),a("h4",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" "),a("strong",[s._v("启动")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动前最好把docker重启，不然原来的tomcat/mysql/redis容器也是启动状态的话，那么端口会冲突而启动失败 ")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mycompose \n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果后台启动则使用如下命令 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若要停止 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" stop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"使用dockerfile创建镜像-根据我们的流程-制作镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用dockerfile创建镜像-根据我们的流程-制作镜像"}},[s._v("#")]),s._v(" 使用Dockerfile创建镜像（根据我们的流程 制作镜像）")]),s._v(" "),a("h4",{attrs:{id:"_1、-什么是dockerfile文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-什么是dockerfile文件-2"}},[s._v("#")]),s._v(" "),a("strong",[s._v("1、")]),s._v(" "),a("strong",[s._v("什么是")]),s._v("Dockerfile文件")]),s._v(" "),a("p",[s._v("前面的课程中已经知道了，要获得镜像，可以从Docker仓库中进行下载。那如果我们想自己开发一个镜像，那该如何做呢？答案是：Dockerfifile")]),s._v(" "),a("p",[s._v("Dockerfifile其实就是一个文本文件，由一系列命令和参数构成，Docker可以读取Dockerfifile文件并根据Dockerfifile文件的描述来构建镜像。")]),s._v(" "),a("p",[s._v("Dockerfifile文件内容一般分为4部分：")]),s._v(" "),a("ul",[a("li",[s._v("基础镜像信息")]),s._v(" "),a("li",[s._v("维护者信息")]),s._v(" "),a("li",[s._v("镜像操作指令")]),s._v(" "),a("li",[s._v("容器启动时执行的指令")])]),s._v(" "),a("h4",{attrs:{id:"_2、dockerfifile常用命令-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、dockerfifile常用命令-2"}},[s._v("#")]),s._v(" 2、Dockerfifile常用命令")]),s._v(" "),a("p",[s._v("Dockerfile可以基于镜像制作镜像；"),a("code",[s._v("docker build -t='jdk1.8' .")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("关键字")]),s._v(" "),a("th",[s._v("作用")]),s._v(" "),a("th",[s._v("备注")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("FROM")]),s._v(" "),a("td",[s._v("指定父镜像")]),s._v(" "),a("td",[s._v("指定dockerfile基于那个image构建")])]),s._v(" "),a("tr",[a("td",[s._v("MAINTAINER")]),s._v(" "),a("td",[s._v("作者信息")]),s._v(" "),a("td",[s._v("用来标明这个dockerfile谁写的")])]),s._v(" "),a("tr",[a("td",[s._v("LABEL")]),s._v(" "),a("td",[s._v("标签")]),s._v(" "),a("td",[s._v("用来标明dockerfile的标签 可以使用Label代替Maintainer 最终都是在docker image基本信息中可以查看")])]),s._v(" "),a("tr",[a("td",[s._v("RUN")]),s._v(" "),a("td",[s._v("执行命令")]),s._v(" "),a("td",[s._v('执行一段命令 默认是/bin/sh 格式: RUN command 或者 RUN ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("CMD")]),s._v(" "),a("td",[s._v("容器启动命令")]),s._v(" "),a("td",[s._v('提供启动容器时候的默认命令 和ENTRYPOINT配合使用.格式 CMD command param1 param2 或者 CMD ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("ENTRYPOINT")]),s._v(" "),a("td",[s._v("入口")]),s._v(" "),a("td",[s._v("一般在制作一些执行就关闭的容器中会使用")])]),s._v(" "),a("tr",[a("td",[s._v("COPY")]),s._v(" "),a("td",[s._v("复制文件")]),s._v(" "),a("td",[s._v("build的时候复制文件到image中")])]),s._v(" "),a("tr",[a("td",[s._v("ADD")]),s._v(" "),a("td",[s._v("添加文件")]),s._v(" "),a("td",[s._v("build的时候添加文件到image中 不仅仅局限于当前build上下文 可以来源于远程服务")])]),s._v(" "),a("tr",[a("td",[s._v("ENV")]),s._v(" "),a("td",[s._v("环境变量")]),s._v(" "),a("td",[s._v("指定build时候的环境变量 可以在启动的容器的时候 通过-e覆盖 格式ENV name=value")])]),s._v(" "),a("tr",[a("td",[s._v("ARG")]),s._v(" "),a("td",[s._v("构建参数")]),s._v(" "),a("td",[s._v("构建参数 只在构建的时候使用的参数 如果有ENV 那么ENV的相同名字的值始终覆盖arg的参数")])]),s._v(" "),a("tr",[a("td",[s._v("VOLUME")]),s._v(" "),a("td",[s._v("定义外部可以挂载的数据卷")]),s._v(" "),a("td",[s._v('指定build的image那些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 -v 绑定 格式 VOLUME ["目录"]')])]),s._v(" "),a("tr",[a("td",[s._v("EXPOSE")]),s._v(" "),a("td",[s._v("暴露端口")]),s._v(" "),a("td",[s._v("定义容器运行的时候监听的端口 启动容器的使用-p来绑定暴露端口 格式: EXPOSE 8080 或者 EXPOSE 8080/udp")])]),s._v(" "),a("tr",[a("td",[s._v("WORKDIR")]),s._v(" "),a("td",[s._v("工作目录")]),s._v(" "),a("td",[s._v("指定容器内部的工作目录 如果没有创建则自动创建 如果指定/ 使用的是绝对地址 如果不是/开头那么是在上一条workdir的路径的相对路径")])]),s._v(" "),a("tr",[a("td",[s._v("USER")]),s._v(" "),a("td",[s._v("指定执行用户")]),s._v(" "),a("td",[s._v("指定build或者启动的时候 用户 在RUN CMD ENTRYPONT执行的时候的用户")])]),s._v(" "),a("tr",[a("td",[s._v("HEALTHCHECK")]),s._v(" "),a("td",[s._v("健康检查")]),s._v(" "),a("td",[s._v("指定监测当前容器的健康监测的命令 基本上没用 因为很多时候 应用本身有健康监测机制")])]),s._v(" "),a("tr",[a("td",[s._v("ONBUILD")]),s._v(" "),a("td",[s._v("触发器")]),s._v(" "),a("td",[s._v("当存在ONBUILD关键字的镜像作为基础镜像的时候 当执行FROM完成之后 会执行 ONBUILD的命令 但是不影响当前镜像 用处也不怎么大")])]),s._v(" "),a("tr",[a("td",[s._v("STOPSIGNAL")]),s._v(" "),a("td",[s._v("发送信号量到宿主机")]),s._v(" "),a("td",[s._v("该STOPSIGNAL指令设置将发送到容器的系统调用信号以退出。")])]),s._v(" "),a("tr",[a("td",[s._v("SHELL")]),s._v(" "),a("td",[s._v("指定执行脚本的shell")]),s._v(" "),a("td",[s._v("指定RUN CMD ENTRYPOINT 执行命令的时候 使用的shell")])])])]),s._v(" "),a("h4",{attrs:{id:"_3、-使用dockerfile创建镜像-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、-使用dockerfile创建镜像-2"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3、")]),s._v(" "),a("strong",[s._v("使用Dockerfile创建镜像")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、创建目录 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" –p /usr/local/dockerjdk8 \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/dockerjdk8 \n\n\nrz "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-be")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、下载jdk-8u231-linux-x64.tar.gz并上传到服务器（虚拟机）中的/usr/local/dockerjdk8目录 ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、在/usr/local/dockerjdk8目录下创建Dockerfile文件，文件内容如下： ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile \n\nFROM centos:7 \nMAINTAINER ITLILS \nWORKDIR /usr \nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/java \nADD jdk-8u231-linux-x64.tar.gz /usr/local/java/ \nENV JAVA_HOME /usr/local/java/jdk1.8.0_231 \nENV JRE_HOME "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre \nENV CLASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v(" \nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、执行命令构建镜像；不要忘了后面的那个 . ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jdk1.8'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、查看镜像是否建立完成 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n\n\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#案例 使用ubuntu作为底层 创建java镜像 同时运行jar项目")]),s._v("\nFROM ubuntu\nMAINTAINER QJJTest\nWORKDIR /usr \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#java")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/java \nADD jdk-8u333-linux-x64.tar.gz /usr/local/java/ \nENV JAVA_HOME /usr/local/java/jdk1.8.0_333 \nENV JRE_HOME "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre \nENV CLASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v(" \nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入项目")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/bin/project\nADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" /usr/bin/project/app.jar\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#以 Java为底包 创建 jar(我们自己项目) 镜像")]),s._v("\nFROM jdk1.8\nMAINTAINER QJJTest\nWORKDIR /usr \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入项目")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/bin/project\nADD spring-test-0.0.1-SNAPSHOT.jar /usr/bin/project/app.jar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#暴露端口")]),s._v("\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行命令")]),s._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(" ,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("-jar"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ,"')]),s._v('"/usr/bin/project/app.jar"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过镜像文件 创建容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8089")]),s._v(":8888 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("java_project_net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" mycompose_dev "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\njava_project\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":8888 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project_test2_net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" mycompose_dev "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nproject_test2\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br")])]),a("h4",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),a("h4",{attrs:{id:"_4、-基于镜像创建容器-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、-基于镜像创建容器-2"}},[s._v("#")]),s._v(" "),a("strong",[s._v("4、")]),s._v(" "),a("strong",[s._v("基于镜像创建容器")])]),s._v(" "),a("p",[s._v("基于刚刚创建的镜像 jdk1.8 创建并启动容器进行测试；")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建并启动容器 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("testjdk jdk1.8 /bin/bash \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容器中测试jdk是否已经安装 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);